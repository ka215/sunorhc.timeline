(function(I,q){typeof exports=="object"&&typeof module<"u"?q(exports):typeof define=="function"&&define.amd?define(["exports"],q):(I=typeof globalThis<"u"?globalThis:I||self,q(I.Sunorhc={}))})(this,function(I){"use strict";var xt=Object.defineProperty;var Ut=(I,q,K)=>q in I?xt(I,q,{enumerable:!0,configurable:!0,writable:!0,value:K}):I[q]=K;var O=(I,q,K)=>(Ut(I,typeof q!="symbol"?q+"":q,K),K);const q="0.9.1",K=e=>e!==null&&typeof e=="object",ue=e=>typeof e=="string"&&e!==""&&!isNaN(Number(e)),fe=e=>typeof e=="string"&&/^(true|false)$/i.test(e),oe=e=>K(e)&&Object.keys(e).length===0&&e.constructor===Object,Ae=e=>/^(https?|ftp):\/\/[^\s/$.?#].[^\s]*$/i.test(e),He=e=>{const t=/^([a-zA-Z]:\\|\/)/,o=/^(\.\/|\.\.\/|[^:]+\/)/;return t.test(e)||o.test(e)},pe=e=>Ae(e)||He(e),Ne=(e,t,o)=>isNaN(e)||o<t?!1:(e=Number(e),(e-t)*(e-o)<=0),Fe=e=>{const t=new Map;for(const s of e)t.set(s,(t.get(s)||0)+1);return Array.from(t.entries()).filter(([s,i])=>i>1).map(([s,i])=>s)},Ye=(e,...t)=>e.replace(/%([%sdf])/g,(o,s)=>{const i=t.shift();switch(s){case"%":return"%";case"s":return String(i);case"d":case"f":return typeof i=="number"?s==="d"?Math.floor(i).toString():i.toFixed(2):"";default:return""}}),le=(e="",t=0)=>{let o=3735928559^t,s=1103547991^t;for(let i=0,r;i<e.length;i++)r=e.charCodeAt(i),o=Math.imul(o^r,2654435761),s=Math.imul(s^r,1597334677);return o=Math.imul(o^o>>>16,2246822507),o^=Math.imul(s^s>>>13,3266489909),s=Math.imul(s^s>>>16,2246822507),s^=Math.imul(o^o>>>13,3266489909),4294967296*(2097151&s)+(o>>>0)},j=(e,t)=>{const o={...e};for(const s in t)Object.prototype.hasOwnProperty.call(t,s)&&(typeof t[s]=="object"&&t[s]!==null&&!Array.isArray(t[s])?typeof o[s]=="object"&&o[s]!==null&&!Array.isArray(o[s])?o[s]=j(o[s],t[s]):o[s]=j({},t[s]):o[s]=t[s]);return o},se=(e,t=new WeakMap)=>{if(e===null||typeof e!="object"||[DOMRect,HTMLElement,DocumentFragment,RegExp,Date].some(i=>e instanceof i))return e;if(t.has(e))return t.get(e);const s=Object.create(Object.getPrototypeOf(e));t.set(e,s);for(const i in e)Object.prototype.hasOwnProperty.call(e,i)&&(s[i]=se(e[i],t));return s},We=e=>JSON.parse(JSON.stringify(e)),ge=(e="UTC",t)=>{const o={year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric",hour12:!1,timeZone:e};return t&&Object.keys(t).length!==0?{...o,...t}:o},Re=(e,t="UTC")=>{const o=ge(t),s=new Intl.DateTimeFormat(void 0,o),i=`${e.toString().padStart(4,"0")}-01-01T00:00:00${t==="UTC"?".000Z":""}`,a=s.formatToParts(new Date(i)).map(({value:c})=>c).join("")+(t==="UTC"?".000Z":"");let l=new Date(a);return e<100&&(l=new Date(t==="UTC"?l.setUTCFullYear(e):l.setFullYear(e))),l},me=(e,t=0,o="UTC")=>{let s=o==="UTC"?new Date(Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),0,0,0,0)):new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),0,0,0,0));e.getFullYear()<100&&(s=new Date(s.setUTCFullYear(e.getFullYear())));const i=Re(s.getUTCFullYear(),"UTC"),r=i.getUTCDay(),a=Math.floor((s.getTime()-i.getTime())/(24*60*60*1e3))+1,l=(7+(r-t))%7,c=a+l;return Math.ceil(c/7)},ze=e=>/^([+-]?\d{1,4}[-\/]\d{1,2}[-\/]\d{1,2}(?:[T\s]\d{1,2}:\d{1,2}(?::\d{1,2}(?:\.\d{1,3})?)?(?:Z|[+-]\d{1,2}:\d{1,2})?)?)$/.test(e),Q=(e,t,o,s,i=0,r)=>{let a,l=!1,c;if(typeof e=="string")if(ze(e)){const T=/^((?<_y>[+-]?\d{1,4})[-\/](?<_m>\d{1,2})[-\/](?<_d>\d{1,2})(?:[T\s](?<_h>\d{1,2}):(?<_mi>\d{1,2})(?::(?<_s>\d{1,2})(?:\.(?<_ms>\d{1,3}))?)?(?:(?<_utc>Z)|(?<_tzo>[+-]\d{1,2}:\d{1,2}))?)?)$/.exec(e);T!=null&&T.groups&&(T==null?void 0:T.length)>0&&(l=!!T.groups._utc,T.groups._y.length>2?a=new Date(Date.UTC(Number(T.groups._y),Number(T.groups._m)-1,Number(T.groups._d),Number(T.groups._h||0),Number(T.groups._mi||0),Number(T.groups._s||0),Number(T.groups._ms||0))):(a=new Date(Date.UTC(100,Number(T.groups._m)-1,Number(T.groups._d),Number(T.groups._h||0),Number(T.groups._mi||0),Number(T.groups._s||0),Number(T.groups._ms||0))),a.setUTCFullYear(Number(T.groups._y))))}else c=new Date(e),a=new Date(Date.UTC(c.getFullYear(),c.getMonth(),c.getDate(),c.getHours(),c.getMinutes(),c.getSeconds(),c.getMilliseconds()));else if(typeof e=="number"&&!Number.isNaN(e))a=new Date(e),l=!0;else if(e instanceof Date)c=e,a=new Date(Date.UTC(c.getUTCFullYear(),c.getUTCMonth(),c.getUTCDate(),c.getUTCHours(),c.getUTCMinutes(),c.getUTCSeconds(),c.getUTCMilliseconds())),c.getUTCFullYear()<100&&a.setUTCFullYear(c.getUTCFullYear()),l=!0;else return null;if(Number.isNaN(a.getTime()))return null;(!t||t==="")&&(t="UTC"),(!o||!Array.isArray(o)||o.length==0)&&(o=["January","February","March","April","May","June","July","August","September","October","November","December"]),(!s||!Array.isArray(s)||s.length==0)&&(s=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]);const d=ye(a,t)||0,h=Math.floor(d/(60*60*1e3))||0,u=Math.floor((d-h*60*60*1e3)/(60*1e3))||0,f=new Date(a.getTime()+(l?d:0)),n=ge(t),g=new Intl.DateTimeFormat(r,n).format(a),[E,$]=g.split(" "),[M,w,C]=E.split("/"),[U,p,m]=$.split(":"),b=parseInt(U,10)-(l?0:h),D=parseInt(p,10)-(l?0:u),S=o[Number(w)-1],k=me(a,i,t),v=t==="UTC"?s[a.getUTCDay()]:s[a.getDay()],P=t==="UTC"?a.getUTCMilliseconds():a.getMilliseconds();let L=a.toISOString(),H=Math.floor(a.getTime()/1e3);if(t!=="UTC"){const T=`${h<0?"-":"+"}${String(Math.abs(h)).padStart(2,"0")}:${String(Math.abs(u)).padStart(2,"0")}`;L=f.toISOString().replace("Z",T),H=Math.floor(new Date(L).getTime()/1e3)}const x=H+62135596800;return{year:parseInt(M,10),month:parseInt(w,10),monthName:S,day:parseInt(C,10),weekday:v,weeks:k,hours:b,minutes:D,seconds:parseInt(m,10),milliseconds:P,ISO:L,ts:H,cept:x,y:(T=4)=>String(parseInt(M,10)).padStart(T,"0"),m:(T=2)=>String(parseInt(w,10)).padStart(T,"0"),mn:(T=0,V=!1)=>T==0?S:S.substring(0,T)+(V&&T<S.length?".":""),d:(T=2)=>String(parseInt(C,10)).padStart(T,"0"),w:(T=2)=>String(k).padStart(T,"0"),wd:(T=0,V=!1)=>T==0?v:v.substring(0,T)+(V&&T<v.length?".":""),h:(T=2)=>String(b).padStart(T,"0"),mi:(T=2)=>String(D).padStart(T,"0"),s:(T=2)=>String(parseInt(m,10)).padStart(T,"0"),ms:(T=3)=>String(P).padStart(T,"0")}},Z=(e,t=null,o=!0)=>{let s=new Date;s=o?new Date(Date.UTC(s.getUTCFullYear(),s.getUTCMonth(),s.getUTCDate(),s.getUTCHours(),s.getUTCMinutes(),s.getUTCSeconds(),0)):new Date(s.getFullYear(),s.getMonth(),s.getDate(),s.getHours(),s.getMinutes(),s.getSeconds(),0);const i=s.valueOf();let r=0,a=0,l=0,c=0,d=0,h=0;try{if(t){const n=t.flags||"",y=new RegExp(t.source,n.includes("g")?n:n+"g"),g=Array.from(e.matchAll(y));if(!g||!g[0].groups)throw new Error("Pattern unmatched");({year:r,month:a,day:l,hours:c,minutes:d,seconds:h}=g[0].groups),r=r?parseInt(r,10):o?s.getUTCFullYear():s.getFullYear(),a=a?parseInt(a,10):o?s.getUTCMonth()+1:s.getMonth()+1,l=l?parseInt(l,10):o?s.getUTCDate():s.getDate(),c=c?parseInt(c,10):o?s.getUTCHours():s.getHours(),d=d?parseInt(d,10):o?s.getUTCMinutes():s.getMinutes(),h=h?parseInt(h,10):o?s.getUTCSeconds():s.getSeconds()}else{const n=new Date(e);if(isNaN(n.getTime()))throw new Error("Invalid date");r=o?n.getUTCFullYear():n.getFullYear(),a=o?n.getUTCMonth()+1:n.getMonth()+1,l=o?n.getUTCDate():n.getDate(),c=o?n.getUTCHours():n.getHours(),d=o?n.getUTCMinutes():n.getMinutes(),h=o?n.getUTCSeconds():n.getSeconds()}if(isNaN(r)||isNaN(a)||isNaN(l)||isNaN(c)||isNaN(d)||isNaN(h))throw new Error("Invalid date components");const f=(o?new Date(Date.UTC(r,a-1,l,c,d,h,0)):new Date(r,a-1,l,c,d,h,0)).valueOf();return i===f}catch(u){return console.error("Failed to parse date in isCurrentDate():",u instanceof Error?u.message:u),!1}},ye=(e,t)=>{const o={timeZone:t,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"},i=new Intl.DateTimeFormat([],o).formatToParts(e),r=i.find(g=>g.type==="year"),a=i.find(g=>g.type==="month"),l=i.find(g=>g.type==="day"),c=i.find(g=>g.type==="hour"),d=i.find(g=>g.type==="minute"),h=i.find(g=>g.type==="second");if(!r||!a||!l||!c||!d||!h)throw new Error(`Invalid time zone specified: ${t}`);const u=`${r.value.padStart(4,"0")}-${a.value}-${l.value}T${c.value}:${d.value}:${h.value}`,f=e.toISOString().substring(0,19),n=Date.parse(`${u}Z`),y=Date.parse(`${f}Z`);return n-y},Be=(e,t,o)=>{const s=new Date(e);switch(o){case"years":s.setUTCFullYear(s.getUTCFullYear()+t);break;case"months":s.setUTCMonth(s.getUTCMonth()+t);break;case"weeks":s.setUTCDate(s.getUTCDate()+t*7);break;case"days":s.setUTCDate(s.getUTCDate()+t);break;case"hours":s.setUTCHours(s.getUTCHours()+t);break;case"minutes":s.setUTCMinutes(s.getUTCMinutes()+t);break;case"seconds":s.setUTCSeconds(s.getUTCSeconds()+t);break;case"milliseconds":s.setUTCMilliseconds(s.getUTCMilliseconds()+t);break}return s},_e=(e,t,o,s="UTC")=>{const i=new Date(e),r=ye(i,s)||0,a=new Date(i.getTime()-r),l=/.+s$/.test(o)?o:o+"s",c=Be(a,t,l);return new Date(c.getTime()+r).getTime()},re=e=>{let t=String(e).toLowerCase();return t=/s$/i.test(t)?t.slice(0,-1):t,t!==""&&/^(year|month|(week|)(day|)|hour|minute|(milli|)second)$/.test(t)?t:!1},qe=(e,t,o)=>{switch(o){case"year":t==="UTC"?(e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)):(e.setMonth(0,1),e.setHours(0,0,0,0));break;case"month":t==="UTC"?(e.setUTCDate(1),e.setUTCHours(0,0,0,0)):(e.setDate(1),e.setHours(0,0,0,0));break;case"week":case"weekday":case"day":t==="UTC"?e.setUTCHours(0,0,0,0):e.setHours(0,0,0,0);break;case"hour":t==="UTC"?e.setUTCMinutes(0,0,0):e.setMinutes(0,0,0);break;case"minute":t==="UTC"?e.setUTCSeconds(0,0):e.setSeconds(0,0);break;case"second":t==="UTC"?e.setUTCMilliseconds(0):e.setMilliseconds(0);break}return e},be=(e,t,o)=>{const s=re(o);if(!s)return new Error(`An unsupported scale was specified: "${o}"`);let i;if(typeof e=="string")if(e.toLowerCase()==="currently"){const r=new Date;let a;t==="UTC"?a=new Date(Date.UTC(r.getFullYear(),r.getMonth(),r.getDate(),r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds())):a=r;const l={year:5,month:6,week:26,weekday:15,day:15,hour:12,minute:30,second:30,millisecond:500};switch(s){case"year":t==="UTC"?a.setUTCFullYear(r.getFullYear()-l[s]):a.setFullYear(r.getFullYear()-l[s]);break;case"month":t==="UTC"?a.setUTCMonth(r.getMonth()-l[s]):a.setMonth(r.getMonth()-l[s]);break;case"week":a.setUTCDate(r.getDate()-l[s]*7);break;case"weekday":case"day":t==="UTC"?a.setUTCDate(r.getDate()-l[s]):a.setDate(r.getDate()-l[s]);break;case"hour":t==="UTC"?a.setUTCHours(r.getHours()-l[s]):a.setHours(r.getHours()-l[s]);break;case"minute":t==="UTC"?a.setUTCMinutes(r.getMinutes()-l[s]):a.setMinutes(r.getMinutes()-l[s]);break;case"second":a.setUTCSeconds(r.getSeconds()-l[s]);break;case"millisecond":t==="UTC"?a.setUTCMilliseconds(r.getMilliseconds()-l[s]):a.setMilliseconds(r.getMilliseconds()-l[s]);break;default:return new Error(`An unsupported scale was specified: "${o}"`)}i=a}else{let r,a=!1;if(/Z|([+-]\d{2}:\d{2})$/.test(e)?(r=new Date(e),a=!0):(r=new Date(e),a=!1),isNaN(r.getTime()))return new Error(`Invalid date strings given: "${e}"`);t==="UTC"?i=a?r:new Date(Date.UTC(r.getUTCFullYear(),r.getUTCMonth(),r.getUTCDate(),r.getUTCHours(),r.getUTCMinutes(),r.getUTCSeconds(),r.getUTCMilliseconds())):i=a?new Date(Date.UTC(r.getFullYear(),r.getMonth(),r.getDate(),r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds())):r}else{if(!(e instanceof Date)||isNaN(e.getTime()))return new Error("Invalid Date object given");i=e}return qe(i,t,s)},we=(e,t,o,s)=>{const i=re(o);if(!i)return new Error(`An unsupported scale was specified: "${o}"`);let r;if(typeof e=="string")if(e.toLowerCase()==="auto"){if(!(s instanceof Date))return new Error("Invalid Date object given start date.");const a=new Date(s.getTime()),l={year:10,month:12,week:52,weekday:30,day:30,hour:24,minute:60,second:60,millisecond:1e3};switch(i){case"year":t==="UTC"?a.setUTCFullYear(s.getUTCFullYear()+l[i]):a.setFullYear(s.getFullYear()+l[i]);break;case"month":t==="UTC"?a.setUTCMonth(s.getUTCMonth()+l[i]):a.setMonth(s.getMonth()+l[i]);break;case"week":t==="UTC"?a.setUTCDate(s.getUTCDate()+l[i]*7):a.setDate(s.getDate()+l[i]*7);break;case"weekday":case"day":t==="UTC"?a.setUTCDate(s.getUTCDate()+l[i]):a.setDate(s.getDate()+l[i]);break;case"hour":t==="UTC"?a.setUTCHours(s.getUTCHours()+l[i]):a.setHours(s.getHours()+l[i]);break;case"minute":t==="UTC"?a.setUTCMinutes(s.getUTCMinutes()+l[i]):a.setMinutes(s.getMinutes()+l[i]);break;case"second":t==="UTC"?a.setUTCSeconds(s.getUTCSeconds()+l[i]):a.setSeconds(s.getSeconds()+l[i]);break;case"millisecond":t==="UTC"?a.setUTCMilliseconds(s.getUTCMilliseconds()+l[i]):a.setMilliseconds(s.getMilliseconds()+l[i]);break}r=new Date(a.getTime()-1)}else{let a,l=!1;if(/Z|([+-]\d{2}:\d{2})$/.test(e)?(a=new Date(e),l=!0):(a=new Date(e),l=!1),isNaN(a.getTime()))return new Error(`Invalid date strings given: "${e}"`);t==="UTC"?r=l?a:new Date(Date.UTC(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate(),a.getUTCHours(),a.getUTCMinutes(),a.getUTCSeconds(),a.getUTCMilliseconds())):r=l?new Date(Date.UTC(a.getFullYear(),a.getMonth(),a.getDate(),a.getHours(),a.getMinutes(),a.getSeconds(),a.getMilliseconds())):a}else{if(!(e instanceof Date)||isNaN(e.getTime()))return new Error("Invalid Date object given");r=e}return r},ne=e=>!(!e||!(e.nodeName||e.prop&&e.attr&&e.find)),G=(e,t)=>{if(!ne(e))return!1;const o=e.getBoundingClientRect();return t?o[t]:o},ee=(e,t="")=>{const o=e.getAttributeNames();if(o.length!==0){if(t===""){const s={};return o.forEach(i=>{const r=e.getAttribute(i);r!==null?s[i]=ue(r)?Number(r):fe(r)?/^true$/i.test(r):r:s[i]=""}),s}if(o.includes(t)){const s=e.getAttribute(t);return s!==null?ue(s)?Number(s):fe(s)?/^true$/i.test(s):s:""}}},A=(e,t)=>{(Array.isArray(e)?e:[e]).forEach(o=>{for(const s in t)typeof s=="string"&&!/^[-+]?\d+$/.test(s)&&Object.prototype.hasOwnProperty.call(t,s)&&o.setAttribute(s,t[s])})},F=(e,t)=>{(Array.isArray(e)?e:[e]).forEach(o=>{if(typeof t=="object")for(const s in t)Object.prototype.hasOwnProperty.call(t,s)&&(o.style[s]=t[s]);else o.style.cssText=String(t)})},X=(e,t,o=!0)=>{typeof e=="string"&&(e=document.getElementById(e)),e instanceof HTMLElement&&(o?e.textContent=t:e.innerHTML=t)},Xe=(e,t,o={})=>{const s=Array.isArray(e)?e:[e];if(!t||typeof t!="function")return;const i={childList:!0,attributes:!0,characterData:!0,subtree:!0,...o};s.forEach(r=>{if(!(r instanceof HTMLElement)){console.error("Watching target is not an HTML element.");return}const a=new MutationObserver(l=>{l.forEach(c=>{t(c,a)})});a.observe(r,i)})},ce=async({url:e="",method:t="get",data:o={},datatype:s="json",timeout:i=5e3}={})=>{const r=new AbortController,a=i>0?setTimeout(()=>{r.abort()},i):null;if(!e||!/^(get|post|put|delete|patch)$/i.test(t))return Promise.reject({type:"bad_request",status:400,message:"Invalid argument(s) given."});const l=new URLSearchParams;let c={method:t,mode:"cors",cache:"no-cache",credentials:"omit",redirect:"follow",referrerPolicy:"no-referrer",signal:r.signal};if(o)for(const d in o)Object.prototype.hasOwnProperty.call(o,d)&&l.append(d,o[d]);t.toLowerCase()!=="get"?c.body=l:l.toString()&&(e+="?"+l);try{const d=await fetch(e,c);if(d.ok){const h=s==="json"?await d.json():await d.text();return Promise.resolve(h)}else{const h=await d.json();return Promise.reject({code:h.code,status:h.status||h.statusText,message:h.message})}}catch(d){d instanceof SyntaxError?console.error(`Response is not valid ${s.toUpperCase()}.`):console.error("Fetch error:",d)}finally{a&&clearTimeout(a)}};function Oe(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var de={exports:{}};de.exports,function(e){var t=function(){var o=String.fromCharCode,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",r={};function a(c,d){if(!r[c]){r[c]={};for(var h=0;h<c.length;h++)r[c][c.charAt(h)]=h}return r[c][d]}var l={compressToBase64:function(c){if(c==null)return"";var d=l._compress(c,6,function(h){return s.charAt(h)});switch(d.length%4){default:case 0:return d;case 1:return d+"===";case 2:return d+"==";case 3:return d+"="}},decompressFromBase64:function(c){return c==null?"":c==""?null:l._decompress(c.length,32,function(d){return a(s,c.charAt(d))})},compressToUTF16:function(c){return c==null?"":l._compress(c,15,function(d){return o(d+32)})+" "},decompressFromUTF16:function(c){return c==null?"":c==""?null:l._decompress(c.length,16384,function(d){return c.charCodeAt(d)-32})},compressToUint8Array:function(c){for(var d=l.compress(c),h=new Uint8Array(d.length*2),u=0,f=d.length;u<f;u++){var n=d.charCodeAt(u);h[u*2]=n>>>8,h[u*2+1]=n%256}return h},decompressFromUint8Array:function(c){if(c==null)return l.decompress(c);for(var d=new Array(c.length/2),h=0,u=d.length;h<u;h++)d[h]=c[h*2]*256+c[h*2+1];var f=[];return d.forEach(function(n){f.push(o(n))}),l.decompress(f.join(""))},compressToEncodedURIComponent:function(c){return c==null?"":l._compress(c,6,function(d){return i.charAt(d)})},decompressFromEncodedURIComponent:function(c){return c==null?"":c==""?null:(c=c.replace(/ /g,"+"),l._decompress(c.length,32,function(d){return a(i,c.charAt(d))}))},compress:function(c){return l._compress(c,16,function(d){return o(d)})},_compress:function(c,d,h){if(c==null)return"";var u,f,n={},y={},g="",E="",$="",M=2,w=3,C=2,U=[],p=0,m=0,b;for(b=0;b<c.length;b+=1)if(g=c.charAt(b),Object.prototype.hasOwnProperty.call(n,g)||(n[g]=w++,y[g]=!0),E=$+g,Object.prototype.hasOwnProperty.call(n,E))$=E;else{if(Object.prototype.hasOwnProperty.call(y,$)){if($.charCodeAt(0)<256){for(u=0;u<C;u++)p=p<<1,m==d-1?(m=0,U.push(h(p)),p=0):m++;for(f=$.charCodeAt(0),u=0;u<8;u++)p=p<<1|f&1,m==d-1?(m=0,U.push(h(p)),p=0):m++,f=f>>1}else{for(f=1,u=0;u<C;u++)p=p<<1|f,m==d-1?(m=0,U.push(h(p)),p=0):m++,f=0;for(f=$.charCodeAt(0),u=0;u<16;u++)p=p<<1|f&1,m==d-1?(m=0,U.push(h(p)),p=0):m++,f=f>>1}M--,M==0&&(M=Math.pow(2,C),C++),delete y[$]}else for(f=n[$],u=0;u<C;u++)p=p<<1|f&1,m==d-1?(m=0,U.push(h(p)),p=0):m++,f=f>>1;M--,M==0&&(M=Math.pow(2,C),C++),n[E]=w++,$=String(g)}if($!==""){if(Object.prototype.hasOwnProperty.call(y,$)){if($.charCodeAt(0)<256){for(u=0;u<C;u++)p=p<<1,m==d-1?(m=0,U.push(h(p)),p=0):m++;for(f=$.charCodeAt(0),u=0;u<8;u++)p=p<<1|f&1,m==d-1?(m=0,U.push(h(p)),p=0):m++,f=f>>1}else{for(f=1,u=0;u<C;u++)p=p<<1|f,m==d-1?(m=0,U.push(h(p)),p=0):m++,f=0;for(f=$.charCodeAt(0),u=0;u<16;u++)p=p<<1|f&1,m==d-1?(m=0,U.push(h(p)),p=0):m++,f=f>>1}M--,M==0&&(M=Math.pow(2,C),C++),delete y[$]}else for(f=n[$],u=0;u<C;u++)p=p<<1|f&1,m==d-1?(m=0,U.push(h(p)),p=0):m++,f=f>>1;M--,M==0&&(M=Math.pow(2,C),C++)}for(f=2,u=0;u<C;u++)p=p<<1|f&1,m==d-1?(m=0,U.push(h(p)),p=0):m++,f=f>>1;for(;;)if(p=p<<1,m==d-1){U.push(h(p));break}else m++;return U.join("")},decompress:function(c){return c==null?"":c==""?null:l._decompress(c.length,32768,function(d){return c.charCodeAt(d)})},_decompress:function(c,d,h){var u=[],f=4,n=4,y=3,g="",E=[],$,M,w,C,U,p,m,b={val:h(0),position:d,index:1};for($=0;$<3;$+=1)u[$]=$;for(w=0,U=Math.pow(2,2),p=1;p!=U;)C=b.val&b.position,b.position>>=1,b.position==0&&(b.position=d,b.val=h(b.index++)),w|=(C>0?1:0)*p,p<<=1;switch(w){case 0:for(w=0,U=Math.pow(2,8),p=1;p!=U;)C=b.val&b.position,b.position>>=1,b.position==0&&(b.position=d,b.val=h(b.index++)),w|=(C>0?1:0)*p,p<<=1;m=o(w);break;case 1:for(w=0,U=Math.pow(2,16),p=1;p!=U;)C=b.val&b.position,b.position>>=1,b.position==0&&(b.position=d,b.val=h(b.index++)),w|=(C>0?1:0)*p,p<<=1;m=o(w);break;case 2:return""}for(u[3]=m,M=m,E.push(m);;){if(b.index>c)return"";for(w=0,U=Math.pow(2,y),p=1;p!=U;)C=b.val&b.position,b.position>>=1,b.position==0&&(b.position=d,b.val=h(b.index++)),w|=(C>0?1:0)*p,p<<=1;switch(m=w){case 0:for(w=0,U=Math.pow(2,8),p=1;p!=U;)C=b.val&b.position,b.position>>=1,b.position==0&&(b.position=d,b.val=h(b.index++)),w|=(C>0?1:0)*p,p<<=1;u[n++]=o(w),m=n-1,f--;break;case 1:for(w=0,U=Math.pow(2,16),p=1;p!=U;)C=b.val&b.position,b.position>>=1,b.position==0&&(b.position=d,b.val=h(b.index++)),w|=(C>0?1:0)*p,p<<=1;u[n++]=o(w),m=n-1,f--;break;case 2:return E.join("")}if(f==0&&(f=Math.pow(2,y),y++),u[m])g=u[m];else if(m===n)g=M+M.charAt(0);else return null;E.push(g),u[n++]=M+g.charAt(0),f--,M=g,f==0&&(f=Math.pow(2,y),y++)}}};return l}();e!=null?e.exports=t:typeof angular<"u"&&angular!=null&&angular.module("LZString",[]).factory("LZString",function(){return t})}(de);var Ie=de.exports;const Te=Oe(Ie),Ge=(e,t,o)=>{let s=-1;if(e.hasOwnProperty("row")&&typeof e.row=="number"&&!Number.isNaN(e.row)&&(e.row>=0?s=t.rowHeight*(e.row>0?e.row-1:e.row):s=t.rowHeight*-1),s===-1)if(e.hasOwnProperty("group")){const i=o.sidebar.items.findIndex(r=>r.hasOwnProperty("group")&&r.group===e.group);i!==-1&&(s=t.rowHeight*i)}else s=0;return s},Ce=(e,t,o)=>{if(oe(o)||o.width<=0||o.hasOwnProperty("endDate")&&o.startDate.ts*1e3+o.startDate.milliseconds===o.endDate.ts*1e3+o.endDate.milliseconds)throw new Error("Could not get the coordinate due to illegal range.");const s=o.minScaleWidth;let i=0,r,a=0,l=-1;switch(e.ts*1e3+e.milliseconds<o.startDate.ts*1e3+o.startDate.milliseconds?l=0:e.ts*1e3+e.milliseconds>o.endDate.ts*1e3+o.endDate.milliseconds&&(l=o.width),t){case"year":for(let c=0;c<Math.ceil(o.width/s);c++){const d=o.startDate[t]+c,h=s*c,u=new Date(Date.UTC(d,0,1));if(e.year===u.getUTCFullYear()){i=h;break}}if(l===-1){const c=new Date(Date.UTC(e.year,0,1)),h=new Date(Date.UTC(e.year,e.month-1,e.day)).getTime()-c.getTime(),u=(new Date(Date.UTC(e.year+1,0,0)).getTime()-c.getTime())/(24*60*60*1e3)+1;r=h+e.hours*60*60*1e3+e.minutes*60*1e3+e.seconds*1e3+e.milliseconds,a=u*24*60*60*1e3,l=r/a*s+i}break;case"month":for(let c=0;c<Math.ceil(o.width/s);c++){const d=o.startDate[t]+c-1,h=s*c,u=new Date(Date.UTC(o.startDate.year,d,1));if(e.year===u.getUTCFullYear()&&e.month===u.getUTCMonth()+1){i=h;break}}if(l===-1){const c=new Date(e.year,e.month,0).getDate(),d=(e.day-1)/c*s;r=e.hours*60*60*1e3+e.minutes*60*1e3+e.seconds*1e3+e.milliseconds,a=r/(c*24*60*60*1e3),l=a*s+d+i}break;case"week":for(let c=0;c<Math.ceil(o.width/s);c++){const d=o.startDate.day+c*7,h=s*c,u=new Date(Date.UTC(o.startDate.year,o.startDate.month-1,d)),f=me(u);if(e.year===u.getUTCFullYear()&&e.month===u.getUTCMonth()+1&&Ne(e.weeks,f-1,f+1)){let n=u.getUTCDate();i=h+(e.day-n)/7*s;break}}l===-1&&(r=e.hours*60*60*1e3+e.minutes*60*1e3+e.seconds*1e3+e.milliseconds,a=7*24*60*60*1e3,l=r/a*s+i);break;case"weekday":case"day":for(let c=0;c<Math.ceil(o.width/s);c++){const d=o.startDate.day+c,h=s*c,u=new Date(Date.UTC(o.startDate.year,o.startDate.month-1,d));if(e.year===u.getUTCFullYear()&&e.month===u.getUTCMonth()+1&&e.day===u.getUTCDate()){i=h;break}}l===-1&&(r=e.hours*60*60*1e3+e.minutes*60*1e3+e.seconds*1e3+e.milliseconds,a=24*60*60*1e3,l=r/a*s+i);break;case"hour":for(let c=0;c<Math.ceil(o.width/s);c++){const d=o.startDate.hours+c,h=s*c,u=new Date(Date.UTC(o.startDate.year,o.startDate.month-1,o.startDate.day,d));if(e.year===u.getUTCFullYear()&&e.month===u.getUTCMonth()+1&&e.day===u.getUTCDate()&&e.hours===u.getUTCHours()){i=h;break}}l===-1&&(r=e.minutes*60*1e3+e.seconds*1e3+e.milliseconds,a=60*60*1e3,l=r/a*s+i);break;case"minute":for(let c=0;c<Math.ceil(o.width/s);c++){const d=o.startDate.minutes+c,h=s*c,u=new Date(Date.UTC(o.startDate.year,o.startDate.month-1,o.startDate.day,o.startDate.hours,d));if(e.year===u.getUTCFullYear()&&e.month===u.getUTCMonth()+1&&e.day===u.getUTCDate()&&e.hours===u.getUTCHours()&&e.minutes===u.getUTCMinutes()){i=h;break}}l===-1&&(r=e.seconds*1e3+e.milliseconds,a=60*1e3,l=r/a*s+i);break;case"second":for(let c=0;c<Math.ceil(o.width/s);c++){const d=o.startDate.seconds+c,h=s*c,u=new Date(Date.UTC(o.startDate.year,o.startDate.month-1,o.startDate.day,o.startDate.hours,o.startDate.minutes,d));if(e.year===u.getUTCFullYear()&&e.month===u.getUTCMonth()+1&&e.day===u.getUTCDate()&&e.hours===u.getUTCHours()&&e.minutes===u.getUTCMinutes()&&e.seconds===u.getUTCSeconds()){i=h;break}}l===-1&&(r=e.milliseconds,a=1e3,l=r/a*s+i);break;case"millisecond":for(let c=0;c<Math.ceil(o.width/s);c++){const d=o.startDate.milliseconds+c,h=s*c,u=new Date(Date.UTC(o.startDate.year,o.startDate.month-1,o.startDate.day,o.startDate.hours,o.startDate.minutes,o.startDate.seconds,d));if(e.year===u.getUTCFullYear()&&e.month===u.getUTCMonth()+1&&e.day===u.getUTCDate()&&e.hours===u.getUTCHours()&&e.minutes===u.getUTCMinutes()&&e.seconds===u.getUTCSeconds()&&e.milliseconds===u.getUTCMilliseconds()){console.log(`getPX!!!?::${e.ISO}:`,d,h,u.toISOString(),l),i=h;break}}l===-1&&(l=i);break}return Math.round(l*1e3)/1e3},Je=(e="md",t)=>{const o=Math.min(t.minScaleWidth,t.rowHeight)/10,s=String(e),i=t.rowHeight-2;let r;switch(s.toLowerCase()){case"xs":r=Math.min(8,Math.floor(o*1.3335));break;case"sm":r=Math.min(12,Math.floor(o*1.8335));break;case"lg":r=Math.max(24,Math.floor(o*3.1628));break;case"xl":r=Math.max(36,Math.floor(o*4.8989));break;default:if(/^[+-]?(\d+(\.\d*)?|\.\d+)([eE][+-]?\d+)?$/.test(s)){const a=Number(s);a<=0?r=Math.min(16,Math.floor(o*2.3428)):r=a<1?Math.floor(a*i):Math.min(a,i)}else r=Math.min(16,Math.floor(o*2.3428));break}return Math.round(r*1e3)/1e3},Ve=(e,t,o)=>{var l,c,d,h,u,f;const s=t.scale,i=se(e);i.uid=le(String(window.performance.now()));const r={width:o.rulerActualWidth,height:o.sidebarHeight,minScaleWidth:Math.floor(o.rulerActualWidth/o.rulerMaxCols),maxRows:o.sidebarItems,rowHeight:o.sidebarItemHeight,startDate:o.startDate,sts:((l=o.startDate)==null?void 0:l.ts)||0,scept:((c=o.startDate)==null?void 0:c.cept)||0,endDate:o.endDate,ets:((d=o.endDate)==null?void 0:d.ts)||0,ecept:((h=o.endDate)==null?void 0:h.cept)||0};if(!i.hasOwnProperty("s")||typeof i.s!="object")return i.x=i.y=-1,i.w=i.h=0,i;const a=Ge(i,r,t);if(i.x=Ce(i.s,s,r),i.h=Math.floor(Je(i.size||"md",r)*1e3)/1e3,i.hasOwnProperty("end")||(i.h=Math.floor(i.h*1e3)/1e3),i.y=Math.floor((a+Math.floor((r.rowHeight-i.h)/2))*1e3)/1e3,i.hasOwnProperty("end")){const n=((u=t.ruler.filters)==null?void 0:u.monthNames)??void 0,y=((f=t.ruler.filters)==null?void 0:f.dayNames)??void 0,g=t.ruler.firstDayOfWeek||0,E=Q(i.end,t.timezone,n,y,g);if(E){i.e=E;const $=Ce(i.e,s,r),M=i.s.ts*1e3+i.s.milliseconds;i.e.ts*1e3+i.e.milliseconds>M&&($>=r.width?i.w=Math.round((r.width-i.x)*1e3)/1e3:i.w=Math.round(($-i.x)*1e3)/1e3)}else i.w=i.h,i.x<r.width-i.w/2&&(i.x=Math.round((i.x-i.w/2)*1e3)/1e3)}else i.w=i.h,i.x<r.width-i.w/2&&(i.x=Math.round((i.x-i.w/2)*1e3)/1e3);return i},Se=(e,t)=>{const o=document.getElementById(e),s=o.querySelectorAll(".sunorhc-timeline-event-node");if(s.length==0)return[];let i=[];Array.from(s).forEach(a=>{const l=a;i.push({id:l.dataset.eventId,type:l.classList.contains("bar-type")?"bar":"pointer",x:l.offsetLeft,y:l.offsetTop,w:l.offsetWidth,h:l.offsetHeight})});let r=null;for(const a in t)switch(a.toLowerCase()){case"latest":t[a]&&(r={id:null,a:0},i.forEach(l=>{r.a<=l.x+l.w&&(r={id:l.id,a:l.x+l.w})}));break;case"id":if(t[a]){const l=new RegExp(`^(EventNode:)?${t[a]}$`,"i");r=i.filter(c=>l.test(c.id))}r=Array.isArray(r)&&r.length>0?r[0]:null;break}return r&&!oe(r)?o.querySelector(`.sunorhc-timeline-event-node[data-event-id="${r.id}"]`):r},$e=(e,t)=>{const o=["year","month","week","weekday","day","hour","minute","second","millisecond"],s=o.findIndex(r=>r===e),i=t.filter(r=>s>=o.findIndex(a=>a===re(r)));return console.log("truncateLowerRulerItems!!!::",e,t,s,i),i},te=(e,t)=>{const o=new RegExp(/%([^%|]+)(\|([^%]+))?%/g),s="ESCAPED_PERCENT";return e=e.replace(/%%/g,s),e.replace(o,(r,a,l,c)=>{const d=a.split(".");let h=t;for(const u of d)if(h&&u in h)h=h[u];else return c!==void 0?c:"";return h!==void 0?String(h):c!==void 0?c:""}).replace(new RegExp(s,"g"),"%")},Ke=(e,t,o,s=!1)=>{typeof o=="object"?o=JSON.stringify(o):typeof o!="string"&&(o=String(o));const i=Te.compressToUTF16(o),r=btoa(encodeURIComponent(i));if(window[e].setItem(t,r),s){const a=`${t}:expiration`,l=JSON.stringify({hash:le(r),cached:new Date().getTime()});window[e].setItem(a,l)}},je=(e,t,o=0)=>{const s=window[e].getItem(t);if(!s)return null;if(o>0){const a=`${t}:expiration`,l=window[e].getItem(a);if(l!==null){const c=JSON.parse(l),d=new Date().getTime();if(c.cached+o<d||c.hash!==le(s))return Qe(e,a,t),null}}const i=decodeURIComponent(atob(s)),r=Te.decompressFromUTF16(i);if(!r)return null;try{return JSON.parse(r)}catch{return r}},Qe=(e,...t)=>{t.forEach(o=>{console.log("removeToStorage:",o,e),window[e].removeItem(o)})},Ze=e=>{const t=e.querySelector(".sunorhc-timeline-main-canvas"),o=Array.from(e.querySelectorAll('.sunorhc-timeline-sidebar[data-sidebar-overflow="true"]'));if(t){let s=!1,i,r,a,l;const c=(u,f)=>{s=!0,t.classList.add("draggable"),o.length>0&&o.forEach(n=>n.classList.add("draggable")),i=u-t.offsetLeft,r=f-t.offsetTop,a=t.scrollLeft,l=t.scrollTop},d=()=>{s=!1,t.classList.remove("draggable"),o.length>0&&o.forEach(u=>u.classList.remove("draggable"))},h=(u,f)=>{if(!s)return;const n=u-t.offsetLeft,y=f-t.offsetTop,g=n-i,E=y-r;t.scrollLeft=a-g,o.length>0&&(t.scrollTop=l-E,o.forEach($=>$.scrollTop=l-E))};t.addEventListener("mousedown",u=>{c(u.pageX,u.pageY)}),t.addEventListener("mouseleave",()=>{d()}),t.addEventListener("mouseup",()=>{d()}),t.addEventListener("mousemove",u=>{s&&(u.preventDefault(),h(u.pageX,u.pageY))}),t.addEventListener("touchstart",u=>{const f=u.touches[0];c(f.clientX,f.clientY)}),t.addEventListener("touchend",()=>{d()}),t.addEventListener("touchcancel",()=>{d()}),t.addEventListener("touchmove",u=>{if(!s)return;u.preventDefault();const f=u.touches[0];h(f.clientX,f.clientY)})}},et=e=>{const t=e.querySelector(".sunorhc-timeline-main-canvas"),o=Array.from(e.querySelectorAll('.sunorhc-timeline-sidebar[data-sidebar-overflow="true"]')),s=[t,...o],i=r=>{s.forEach(a=>{r?a.classList.add("wheelable"):a.classList.remove("wheelable")})};if(t){let r=!1;s.forEach(a=>{a.addEventListener("mouseenter",()=>{r=!0,i(r)}),a.addEventListener("mouseleave",()=>{r=!1,i(r)}),a.addEventListener("wheel",d=>{r&&(d.preventDefault(),Array.from(e.querySelectorAll(".wheelable")).forEach(h=>{h instanceof HTMLElement&&h.scrollBy({top:d.deltaY,left:d.deltaX,behavior:"smooth"})}))});let l,c;a.addEventListener("touchstart",d=>{const h=d.touches[0];c=h.clientX,l=h.clientY}),a.addEventListener("touchmove",d=>{if(d.touches.length!==1)return;const h=d.touches[0],u=h.clientX,f=h.clientY,n=c-u,y=l-f;Array.from(e.querySelectorAll(".wheelable")).forEach(g=>{g instanceof HTMLElement&&g.scrollBy({top:y,left:n,behavior:"smooth"})}),c=u,l=f}),a.addEventListener("touchend",()=>{}),a.addEventListener("touchcancel",()=>{})})}},xe=(e,t)=>{if(!e||!/^(\d+|left|begin|center|right|end|current(|ly)|latest)$/.test(String(t)))return;const o=e.querySelector(".sunorhc-timeline-nodes").scrollWidth,s=e.querySelector(".sunorhc-timeline-main-canvas"),i=s.offsetWidth;switch(console.log("Called doAlignment:",t,o,i),t){case"left":case"begin":s.scrollLeft>0&&s.scrollTo({top:0,left:0,behavior:"smooth"});break;case"center":s.scrollLeft>0&&s.scrollTo({left:0});const r=Math.abs(i/2-o/2);s.scrollBy({top:0,left:r,behavior:"smooth"});break;case"right":case"end":s.scrollLeft<o&&s.scrollTo({top:0,left:o,behavior:"smooth"});break;case"current":case"currently":const a=e.querySelector('[data-ruler-grain="min"] > [data-item-present-time="true"]');a&&(s.scrollTo({top:0,left:a.offsetLeft,behavior:"smooth"}),a.dispatchEvent(new MouseEvent("mouseover",{bubbles:!0,cancelable:!0,view:window})));break;case"latest":const l=Se(e.id,{latest:!0});ne(l)&&(l.dispatchEvent(new MouseEvent("mouseover",{bubbles:!0,cancelable:!0,view:window})),s.scrollTo({top:0,left:l.offsetLeft,behavior:"smooth"}));break;default:const c=Se(e.id,{id:t});ne(c)&&(c.dispatchEvent(new MouseEvent("mouseover",{bubbles:!0,cancelable:!0,view:window})),s.scrollTo({top:0,left:c.offsetLeft,behavior:"smooth"}));break}},tt=(e,t,o)=>{let s=!1;const i=document.createDocumentFragment(),r=e.querySelector(".sunorhc-timeline-body"),a=Array.from(e.querySelectorAll(".sunorhc-timeline-event-node")),l=document.createElement("div");l.classList.add("sunorhc-timeline-tooltip-container"),r.append(l);const c=h=>{h.preventDefault();const u=l.querySelector(".sunorhc-timeline-tooltip");u&&(l.removeChild(u),F(l,{zIndex:"-1"})),s=!1},d=h=>{var S;h.preventDefault();let u,f,n,y,g,E,$;if(h instanceof MouseEvent)$=h.target,u=h.clientX,f=h.clientY,n=h.offsetX,y=h.offsetY,g=h.pageX,E=h.pageY;else if(h instanceof TouchEvent)if(h.touches.length>0){const k=h.touches[0];u=k.clientX,f=k.clientY,g=k.pageX,E=k.pageY,$=k.target;const v=$.getBoundingClientRect();n=k.clientX-v.left,y=k.clientY-v.top}else return;const M={type:h.type,clientX:u,clientY:f,offsetX:n,offsetY:y,pageX:g,pageY:E,target:$},w=G(e.querySelector(".sunorhc-timeline-tooltip-container")),C=window.scrollX,U=window.scrollY,p={left:w.left+C,top:w.top+U,right:w.right+C,bottom:w.bottom+U},b=M.target.dataset.eventId,D=o.filter(k=>k.eventId===b);if(D.length>0){const k=D.shift();F(l,{zIndex:"80"});const v=document.createElement("div");v.classList.add("sunorhc-timeline-tooltip");const P=t.effects.hasOwnProperty("template")&&((S=t.effects.template)!=null&&S.hasOwnProperty("tooltip"))?t.effects.template.tooltip:"<label>%label%</label>";X(v,te(P,k),!1),l.append(v),i.append(l),r.append(i);const L=G(v),H=12;let x,T;E-p.top>=p.bottom-E?(x="top",T=[`--tooltip-top: ${Math.ceil(E-p.top-(L.height+H*1.5))}px`,`--tooltip-left: ${Math.ceil(g-p.left-L.width/2)}px`]):(x="bottom",T=[`--tooltip-top: ${Math.ceil(E-p.top+H)}px`,`--tooltip-left: ${Math.ceil(g-p.left-L.width/2)}px`]),g-p.left<L.width/2&&(x="right",T=[`--tooltip-top: ${Math.ceil(E-p.top-L.height/2)}px`,`--tooltip-left: ${Math.ceil(g-p.left+H*1.5)}px`]),p.right-g<L.width/2&&(x="left",T=[`--tooltip-top: ${Math.ceil(E-p.top-L.height/2)}px`,`--tooltip-left: ${Math.ceil(g-p.left-(L.width+H*1.5))}px`]),v.classList.add(x),F(v,T.join("; ")),v.classList.add("shown"),s=!0}};a.forEach(h=>{h.addEventListener("mouseout",u=>{c(u)}),h.addEventListener("mouseover",u=>{s||(u.stopPropagation(),d(u))}),h.addEventListener("touchend",u=>{c(u)}),h.addEventListener("touchstart",u=>{s||(u.stopPropagation(),c(u))})})},ot=(e,t)=>{var h,u;const o=e.querySelector(".sunorhc-timeline-main-canvas"),s=[...Array.from(o.querySelectorAll(".sunorhc-timeline-ruler")),o.querySelector(".sunorhc-timeline-nodes")];let i=0;const r=(f,n)=>{const y=o.querySelector(".sunorhc-timeline-nodes"),g=f/y.clientWidth,E=be(t.start,t.timezone,t.scale),$=we(t.end,t.timezone,t.scale,E),M=Q(E,t.timezone),C=Q($,t.timezone).ts-M.ts,U=(g*C+M.ts)*1e3,p=new Date(U),m=(x,T)=>String(x).padStart(T,"0"),b=p.getUTCFullYear(),D=m(p.getUTCMonth()+1,2),S=m(p.getUTCDate(),2),k=m(p.getUTCHours(),2),v=m(p.getUTCMinutes(),2),P=m(p.getUTCSeconds(),2),L=m(p.getUTCMilliseconds(),3);let H="";switch(n){case"year":H=b.toString();break;case"month":H=`${b}-${D}`;break;case"week":case"weekday":case"day":H=`${b}-${D}-${S}`;break;case"hour":H=`${b}-${D}-${S}T${k}`;break;case"minute":H=`${b}-${D}-${S}T${k}:${v}`;break;case"second":H=`${b}-${D}-${S}T${k}:${v}:${P}`;break;case"millisecond":H=`${b}-${D}-${S}T${k}:${v}:${P}.${L}`;break}return H},a=(f,n)=>{var D;const y=f.target;let g="",E="auto",$=t.scale,M="",w=Number(t.ruler.minGrainWidth);y.nodeName==="LI"?(g=y.dataset.itemDatetime||"",$=re(((D=y.parentElement)==null?void 0:D.dataset.rulerType)||""),$||($=t.scale)):g=r(n,$);let C=null,U=null,p=null;switch($){case"year":M="month",g=`${g}-01-01T00:00:00.000`,w=Math.ceil(o.clientWidth/12);break;case"month":if(M="day",C=/^(?<year>\d{1,4})-(?<month>\d{2})$/.exec(g),C&&C.groups){const{year:S,month:k}=C.groups,P=new Date(new Date(Date.UTC(Number(S),Number(k),1,0,0,0)).getTime()-1).getUTCDate();w=Math.ceil(o.clientWidth/P),E=`${g}-${P}T23:59:59.999`}else w=Math.ceil(o.clientWidth/30);g=`${g}-01T00:00:00.000`;break;case"week":if(M="day",C=/^(?<year>\d{1,4})-(?<week>\d{2})$/.exec(g),C&&C.groups){const{year:S,week:k}=C.groups;let v=1;for(let P=1;P<=Number(k)*7;P++){const L=new Date(Date.UTC(Number(S),0,P,0,0,0));if(L.getUTCDay()===t.ruler.firstDayOfWeek&&(v++,v===Number(k))){g=L.toISOString().replace(/Z$/,""),E=`${S}-${String(L.getUTCMonth()+1).padStart(2,"0")}-${String(L.getUTCDate()+6).padStart(2,"0")}T23:59:59.999`;break}}}w=Math.ceil(o.clientWidth/7);break;case"weekday":case"day":if(M="hour",U=g.replace(/(,\w+)$/,""),g=`${U}T00:00:00.000`,C=/^(?<year>\d{1,4})-(?<month>\d{2})-(?<day>\d{2})$/.exec(U),C&&C.groups){const{year:S,month:k,day:v}=C.groups;p=Number(v)+1,E=`${S}-${k.padStart(2,"0")}-${String(p).padStart(2,"0")}T00:00:00.000`}w=60;break;case"hour":if(M="minute",U=g,g=`${U}:00:00.000`,C=/^(?<year>\d{1,4})-(?<month>\d{2})-(?<day>\d{2})T(?<hours>\d{2})$/.exec(U),C&&C.groups){const{year:S,month:k,day:v,hours:P}=C.groups;p=Number(P)+1,E=`${S}-${k.padStart(2,"0")}-${v.padStart(2,"0")}T${String(p).padStart(2,"0")}:00:00.000`}w=Math.ceil(o.clientWidth/60);break;case"minute":if(M="second",U=g,g=`${U}:00.000`,C=/^(?<year>\d{1,4})-(?<month>\d{2})-(?<day>\d{2})T(?<hours>\d{2}):(?<minutes>\d{2})$/.exec(U),C&&C.groups){const{year:S,month:k,day:v,hours:P,minutes:L}=C.groups;p=Number(L)+1,E=`${S}-${k.padStart(2,"0")}-${v.padStart(2,"0")}T${P.padStart(2,"0")}:${String(p).padStart(2,"0")}:00.000`}w=Math.ceil(o.clientWidth/60);break;case"second":if(M="millisecond",U=g,g=`${U}.000`,C=/^(?<year>\d{1,4})-(?<month>\d{2})-(?<day>\d{2})T(?<hours>\d{2}):(?<minutes>\d{2}):(?<seconds>\d{2})$/.exec(U),C&&C.groups){const{year:S,month:k,day:v,hours:P,minutes:L,seconds:H}=C.groups;p=Number(H)+1,E=`${S}-${k.padStart(2,"0")}-${v.padStart(2,"0")}T${P.padStart(2,"0")}:${L.padStart(2,"0")}:${String(p).padStart(2,"0")}.000`}w=Math.ceil(o.clientWidth/1e3);break;case"millisecond":default:M=t.scale;break}g+=t.timezone==="UTC"?"Z":"",E+=E!=="auto"&&t.timezone==="UTC"?"Z":"";const m={...t.ruler};M!=="millisecond"?m.minGrainWidth=w&&w<48?48:w:m.minGrainWidth=w&&w<30?30:w,t.ruler.hasOwnProperty("truncateLowers")&&t.ruler.truncateLowers&&(m.hasOwnProperty("top")&&m.top.rows.length>0&&(m.top.rows=$e(M,m.top.rows)),m.hasOwnProperty("bottom")&&m.bottom.rows.length>0&&(m.bottom.rows=$e(M,m.bottom.rows)));const b={prevScale:$,scale:M,start:g,end:E,ruler:m};window.hasOwnProperty("SunorhcTimelineInstances")&&window.SunorhcTimelineInstances[e.id].zoom(b)};t.debug&&((h=t.extends)!=null&&h.zoomScaleTracker)&&((u=o.querySelector(".sunorhc-timeline-nodes"))==null||u.addEventListener("mousemove",f=>{const n=e.querySelector(".zoom-scale-coordinates-tracker");if(!n)return;let y=n.getAttribute("style");y=y==null?void 0:y.split(";").map(E=>E.trim().replace(/^display\:\s?none$/,"display: flex"));const g=r(f.offsetX,t.scale);n.innerHTML=`<ul>            <li><label>offsetX:</label><span style="color: blue;">${f.offsetX}</span>, <label>offsetY:</label><span style="color: blue;">${f.offsetY}</span></li>            <li><label>pageX:</label><span style="color: blue;">${f.pageX}</span>, <label>pageY:</label><span style="color: blue;">${f.pageY}</span></li>            <li><label>Date:</label> <span style="color: red;">${g}</span></li>            </ul>`,n.setAttribute("style",y.join("; "))}));const l=f=>{if(f.touches.length===2){const n=f.touches[0],y=f.touches[1],g=Math.hypot(n.pageX-y.pageX,n.pageY-y.pageY);f.target.dataset.initialTouchDistance=g.toString()}},c=f=>{if(f.touches.length===2){const n=f.touches[0],y=f.touches[1];if(parseFloat(f.target.dataset.initialTouchDistance||"0")>0){const E=(n.pageX+y.pageX)/2-o.getBoundingClientRect().left;a(f,E)}}},d=f=>{const n=new Date().getTime();if(n-i<=300){const g=f.changedTouches[0].pageX-o.getBoundingClientRect().left;a(f,g)}i=n};o.addEventListener("touchstart",l,{passive:!0}),o.addEventListener("touchmove",c,{passive:!0}),o.addEventListener("touchend",d,{passive:!0}),s.forEach(f=>{f.addEventListener("dblclick",n=>{const y=n.offsetX;a(n,y)})})},st=(e,t,o)=>{let s=0;const i=(d,h="auto")=>{d&&d.stopPropagation();const u=document.getElementById("sunorhc-timeline-modal");if(!u)return;const f=u.querySelector(".sunorhc-timeline-modal-dialog-ref");if(h==="auto"?f.classList.contains("shown"):h!=="show")f.classList.remove("shown"),setTimeout(()=>{F(u,{display:"none"}),document.body.style.position="",document.body.style.top="",document.body.style.width="",window.scrollTo({top:s,left:0,behavior:"instant"})},300);else{F(u,{display:"block"}),s=window.scrollY;const y=window.innerWidth-document.documentElement.clientWidth;document.body.style.position="fixed",document.body.style.top=`-${s}px`,document.body.style.width=`calc(100% - ${y}px)`,setTimeout(()=>{f.classList.add("shown")},1)}},r=(d,h)=>typeof d[h]=="function",a=async d=>{if(d.hasOwnProperty("content")&&pe(d.content||"")){let h=!0;const u=d.hasOwnProperty("expiration")?d.expiration:"none";if(d.hasOwnProperty("extends")&&d.extends.hasOwnProperty("remoteContent")&&(typeof u=="number"&&d.extends.hasOwnProperty("cached")?h=new Date().getTime()>d.extends.cached+u*1e3:u!=="always"&&(h=!1)),h){const f=await ce({url:d.content});f.hasOwnProperty("content")&&(d.hasOwnProperty("extends")?d.extends.remoteContent=f.content.toString():d.extends={remoteContent:f.content.toString()},f.hasOwnProperty("label")&&(d.extends.remoteLabel=f.label.toString()),typeof u=="number"&&(d.extends.cached=new Date().getTime()))}}else console.warn("Invalid remote URL from which content can be retrieved:",d.content);return d},l=async(d,h)=>{var u,f,n,y,g,E,$,M,w,C,U,p,m;try{h.hasOwnProperty("remote")&&h.remote&&(h=await a(h));let b="";switch(d){case"modal":let D=document.getElementById("sunorhc-timeline-modal"),S={size:"medium",header:void 0,body:void 0},k="500px",v=(u=h.extends)!=null&&u.remoteLabel?h.extends.remoteLabel:(f=h.label)==null?void 0:f.toString(),P=(n=h.extends)!=null&&n.remoteContent?h.extends.remoteContent:(y=h.content)==null?void 0:y.toString(),L="";if(t.effects.hasOwnProperty("template")&&((g=t.effects.template)!=null&&g.hasOwnProperty("modal"))&&!oe((E=t.effects.template)==null?void 0:E.modal)&&(S={...S,...t.effects.template.modal}),D)S.hasOwnProperty("header")&&S.header&&S.header!==""&&(v=te(S.header,h)),S.hasOwnProperty("body")&&S.body&&S.body!==""&&(P=te(S.body,h)),X(D.querySelector(".sunorhc-timeline-modal-title"),v,!1),X(D.querySelector(".sunorhc-timeline-modal-body"),P,!1),L!==""&&X(D.querySelector(".sunorhc-timeline-modal-footer"),L,!1);else{switch(D=document.createElement("div"),D.id="sunorhc-timeline-modal",D.classList.add("sunorhc-timeline-modal-container"),A(D,{tabindex:"-1",role:"dialog"}),S.size){case"full":k="100vw";break;case"extralarge":k="calc(100% - 4rem)";break;case"large":k="800px";break;case"medium":k="500px";break;case"small":k="300px";break;default:typeof S.size=="number"&&(k=`${S.size}px`);break}S.hasOwnProperty("header")&&S.header&&S.header!==""&&(v=te(S.header,h)),S.hasOwnProperty("body")&&S.body&&S.body!==""&&(P=te(S.body,h)),!S.hasOwnProperty("footer")||S.footer===void 0?L='<button type="button" class="sunorhc-timeline-modal-close">Close</button>':S.footer===null||S.footer===""?L="":L=te(S.footer,h);const x=`	<div class="sunorhc-timeline-modal-dialog-ref"></div>	<div class="sunorhc-timeline-modal-dialog${S.size==="full"?" fullsize":""}" style="--modal-width: ${k};">		<div class="sunorhc-timeline-modal-header">			<h3 class="sunorhc-timeline-modal-title">${v}</h3>
			<button type="button" class="sunorhc-timeline-modal-dismiss"><span><svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" /></svg></span></button>		</div>		<div class="sunorhc-timeline-modal-body">${P}</div>		<div class="sunorhc-timeline-modal-footer"${L===""?' style="display: none;"':""}>			${L}		</div>	</div>`;X(D,x,!1),($=e.parentElement)==null||$.insertBefore(D,e.nextSibling),document.querySelector(".sunorhc-timeline-modal-dismiss").addEventListener("click",T=>{i(T)}),document.querySelector(".sunorhc-timeline-modal-dialog-ref").addEventListener("click",T=>{T.preventDefault(),i(T)}),(M=document.querySelector(".sunorhc-timeline-modal-close"))==null||M.addEventListener("click",T=>{i(T)})}i(void 0,"show");break;case"custom":if(t.effects.hasOwnProperty("template")&&((w=t.effects.template)!=null&&w.hasOwnProperty("custom")))if(typeof t.effects.template.custom=="function")t.effects.template.custom(h,t);else if(typeof t.effects.template.custom=="string"){let x=t.effects.template.custom;if(console.log("custom handle as string:",x),globalThis.hasOwnProperty(x)&&r(globalThis,x))globalThis[x](h,t);else throw new Error(`Function to be called could not be found: ${x}()`)}else throw new Error("Invalid handler for processing the event detail data.");break;case"normal":const H=document.getElementById("sunorhc-timeline-event-details");if(H){const x=(C=h.extends)!=null&&C.remoteLabel?h.extends.remoteLabel:(U=h.label)==null?void 0:U.toString(),T=(p=h.extends)!=null&&p.remoteContent?h.extends.remoteContent:(m=h.content)==null?void 0:m.toString();if(b=`<h3>${x||""}</h3><p>${T||""}</p>`,t.effects.hasOwnProperty("template")&&t.effects.template.details){const V={...h,label:x,content:T};b=te(t.effects.template.details,V)}X(H,b,!1)}else throw new Error("No element into which timeline event details can be injected.");break;default:throw new Error("Invalid action as event opener.")}}catch(b){console.error("Failed to open the event:",b);return}finally{h.hasOwnProperty("callback")&&typeof h.callback=="function"&&h.callback(h)}};Array.from(e.querySelectorAll(".sunorhc-timeline-event-node")).forEach(d=>{const h=ee(d,"style");A(d,{style:`${h.toString().replace(/;$/,"")}; --event-node-cursor: pointer;`}),d.addEventListener("click",u=>{const f=u.target,n=o.filter(y=>y.eventId===f.dataset.eventId).shift();l(t.effects.onClickEvent,n)})})},J=e=>{var s;if(!e)return 0;if(typeof e=="number")return e;const t=parseFloat(String(e)),o=(s=String(e).match(/[\d.\-\+]*\s*(.*)/))==null?void 0:s[1];if(o==="px")return t;if(o==="rem"){const i=parseFloat(getComputedStyle(document.documentElement).fontSize);return t*i}else if(o==="em"||o==="%"){const i=parseFloat(getComputedStyle(document.body).fontSize);return o==="em"?t*i:t/100*i}else{if(o==="vw")return t*window.innerWidth/100;if(o==="vh")return t*window.innerHeight/100}return 0},Ue=(e,t,o)=>{const s=new Date(Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds())),i=new Date(Date.UTC(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate(),t.getUTCHours(),t.getUTCMinutes(),t.getUTCSeconds(),t.getUTCMilliseconds())),a=i.getTime()-s.getTime(),l=Math.floor(a/1e3),c=Math.floor(l/60),d=Math.floor(c/60);let h=Math.floor(d/24);const u=Math.floor(h/7),f=s.getUTCFullYear(),n=s.getUTCMonth(),y=i.getUTCFullYear(),g=i.getUTCMonth();let E=y-f,$=g-n+E*12;const M=$%12,w=new Date(s.getTime());w.setUTCFullYear(s.getUTCFullYear()+E,M,1);let C=i.getUTCDate()-w.getUTCDate();w.setUTCDate(w.getUTCDate()+C);const U=i.getUTCHours()-w.getUTCHours();w.setUTCHours(w.getUTCHours()+U);const p=i.getUTCMinutes()-w.getUTCMinutes();w.setUTCMinutes(w.getUTCMinutes()+p);const m=i.getUTCSeconds()-w.getUTCSeconds();w.setUTCSeconds(w.getUTCSeconds()+m);const b=i.getUTCMilliseconds()-w.getUTCMilliseconds();Math.max(U,p,m,b,0)>0&&(h+=1);const D={years:E+1,months:$+1,weeks:u+1,days:h,weekdays:h,hours:d,minutes:c,seconds:l,milliseconds:a};if(o&&/^(year|month|week|(week|)day|hour|minute|(milli|)second)s?$/i.test(o)){const S=o.toLowerCase(),k=S.endsWith("s")?S:S+"s";if(D.hasOwnProperty(k))return D[k]}return D},Me=(e,t)=>{const o=r=>{let a=[],l=null,c=[];for(const d in r)switch(d){case"textAlign":l=r[d].match(/^(?<alignment>(left|center|right))$/),l!=null&&l.groups.alignment&&a.push(`text-align: ${l.groups.alignment}`);break;case"textColor":a.push(`color: ${r[d]}`);break;case"textStyles":c=r[d].split(";"),Array.isArray(c)&&c.length>0&&a.push(...c);break}return a.length>0?a.join("; "):""},s=document.createElement("div");s.classList.add(`sunorhc-timeline-${e}`);let i={};if(t.display||(i.hidden="true"),t.id&&t.id!==""&&(i.id=t.id),t.flexDirection&&t.flexDirection!==""&&(i["data-flex-direction"]=/^(column|row)$/.test(t.flexDirection)?t.flexDirection:"column"),A(s,i),t.label){const r=document.createElement(e==="header"?"h2":"p");t.textClass&&t.textClass!==""&&A(r,{class:t.textClass});const a=o(t);F(r,a),X(r,t.label,!1),s.append(r)}return s},Ee=(e,t)=>{if(!/^(left|right)$/i.test(e))return;const o=document.createElement("div");return o.classList.add("sunorhc-timeline-sidebar"),A(o,{"data-sidebar-position":e,"data-sidebar-max-width":t.sidebarWidth.toString(),"data-sidebar-max-height":t.sidebarHeight.toString()}),F(o,`        --sidebar-max-width: ${t.sidebarWidth}px;         --sidebar-item-height: ${t.sidebarItemHeight}px;         margin-top: ${t.sidebarOffsetTop}px;         margin-bottom: ${t.sidebarOffsetBottom}px;     `),o},nt=e=>{const t=document.createElement("ul");return t.classList.add("sunorhc-timeline-sidebar-items"),A(t,{"data-alternate-rows":"true"}),e.hasOwnProperty("items")&&e.items.length>0&&e.items.forEach((o,s)=>{const i=document.createElement("li"),r=(h,u,f=!1)=>{let n="",y;u.textPosition&&u.textPosition!==""&&!f&&(y=u.textPosition.match(/^(?<valign>(center|top|bottom)?)\s+(?<halign>(center|left|right)?)$/),y!=null&&y.groups.valign&&(n+=`vertical-align: ${y.groups.valign};`),y!=null&&y.groups.halign&&(n+=`text-align: ${y.groups.halign};`)),u.textColor&&u.textColor!==""&&(n+=`color: ${u.textColor};`),u.textStyles&&u.textStyles!==""&&(n+=u.textStyles),n!==""&&F(h,n)};let a,l,c,d={tabindex:String(s+1)};switch(o.group&&o.group!==""&&(d["data-sidebar-item-group"]=o.group),o.action&&o.action!==""&&(d["data-sidebar-item-action"]=pe(o.action)?`location.assign('${o.action}')`:o.action),o.onClick&&typeof o.onClick=="boolean"&&(d.onClick="Function(`return ${this.dataset.sidebarItemAction}`)()"),A(i,d),F(i,{height:String(e.itemHeight||"80px")}),!0){case/^text$/i.test(o.type):l=document.createElement("span"),A(l,{"data-sidebar-item-type":o.type,"data-text-overflow":o.textOverflow?"hidden":"static",title:o.label}),r(l,o),X(l,o.label),i.append(l);break;case/^avatar$/i.test(o.type):case/^icon$/i.test(o.type):a=document.createElement("span"),A(a,{"data-sidebar-item-type":o.type}),o.type==="avatar"?(c=new Image,c.src=o.src,F(a,{height:"100%",width:"auto"})):(c=document.createElement("i"),A(c,{class:o.iconClass||""}),c.textContent=o.iconContent||"",A(a,{class:o.iconWrapClass||""})),a.append(c),!o.label||o.label===""?i.append(a):(l=document.createElement("span"),A(l,{"data-sidebar-item-type":"text","data-text-overflow":o.textOverflow?"hidden":"static",title:o.label}),r(l,o),X(l,o.label),i.append(a,l));break;case/^image$/i.test(o.type):a=document.createElement("span"),A(a,{"data-sidebar-item-type":o.type,"data-image-src":o.src}),F(a,`--bg-image: url('${o.src}')`),!o.label||o.label===""?i.append(a):(l=document.createElement("span"),A(l,{"data-sidebar-item-type":"caption","data-caption-position":o.textPosition||"center","data-caption-color":o.textColor||"","data-caption-overflow":o.textOverflow?"hidden":"static",title:o.label}),r(l,o,!0),X(l,`<span>${o.label}</span>`,!1),i.append(a,l));break}t.append(i)}),t},ke=(e,t)=>{if(!/^(top|bottom)$/i.test(e))return;const o=document.createElement("div");return o.classList.add("sunorhc-timeline-ruler"),A(o,{"data-ruler-position":e,"data-ruler-rows":String(/^top$/i.test(e)?t.rulerTopRows:t.rulerBottomRows),"data-ruler-max-cols":t.rulerMaxCols.toString(),"data-alternate-rows":"true"}),o},it=e=>{const t=document.createElement("ul");if(t.classList.add("sunorhc-timeline-ruler-row"),A(t,{"data-ruler-type":e.scale,"data-ruler-order":e.order.toString()}),F(t,`--min-grain-width: ${e.minGrainWidth}px;`),e.order==e.config.rows.length?(A(t,{"data-ruler-grain":e.placement==="top"?"min":"max"}),t.classList.add("last-order-row")):e.order==1&&A(t,{"data-ruler-grain":e.placement==="top"?"max":"min"}),e.hasOwnProperty("maxCols")&&e.maxCols>0){const o=document.createDocumentFragment(),s=["sun","mon","tue","wed","thu","fri","sat"];let i=0,r={},a,l;for(let c=0;c<e.maxCols;c++){const d=e.filters?e.filters.decorations:void 0,h=e.filters?e.filters.monthNames:void 0,u=e.filters?e.filters.dayNames:void 0,f=_e(e.startDate.ts*1e3+e.startDate.milliseconds,c,e.globalScale,e.timezone),n=Q(new Date(f),e.timezone,h,u,e.firstDayOfWeek);i++;let y=!1,g=e.scale.toLowerCase();switch(g=g.endsWith("s")?g.slice(0,-1):g,g){case"year":a=n==null?void 0:n.y(1),l=n==null?void 0:n.y(1),y=Z(n==null?void 0:n.ISO,/^(?<year>\d+)-.*$/,e.timezone==="UTC");break;case"month":a=`${n==null?void 0:n.y(4)}-${n==null?void 0:n.m(2)}`,e.filters&&e.filters.monthFormat==="name"?l=n==null?void 0:n.mn(e.filters.abbreviateMonthNameLength||0,e.filters.fullStop||!1):l=n==null?void 0:n.m(1),y=Z(n==null?void 0:n.ISO,/^(?<year>\d+)-(?<month>\d+)-.*$/,e.timezone==="UTC");break;case"week":a=`${n==null?void 0:n.y(4)}-${n==null?void 0:n.w(2)}`,l=n==null?void 0:n.w(1);break;case"day":a=`${n==null?void 0:n.y(4)}-${n==null?void 0:n.m(2)}-${n==null?void 0:n.d(2)}`,a=`${a},${s[new Date(a).getUTCDay()]}`,l=n==null?void 0:n.d(1),y=Z(n==null?void 0:n.ISO,/^(?<year>\d+)-(?<month>\d+)-(?<day>\d+)T.*$/,e.timezone==="UTC");break;case"weekday":a=`${n==null?void 0:n.y(4)}-${n==null?void 0:n.m(2)}-${n==null?void 0:n.d(2)}`,a=`${a},${s[new Date(a).getUTCDay()]}`,e.filters?l=n==null?void 0:n.wd(e.filters.abbreviateDayNameLength||0,e.filters.fullStop||!1):l=n==null?void 0:n.wd(),y=Z(n==null?void 0:n.ISO,/^(?<year>\d+)-(?<month>\d+)-(?<day>\d+)T.*$/,e.timezone==="UTC");break;case"hour":a=`${n==null?void 0:n.y(4)}-${n==null?void 0:n.m(2)}-${n==null?void 0:n.d(2)}T${n==null?void 0:n.h(2)}`,l=n==null?void 0:n.h(1),y=Z(n==null?void 0:n.ISO,/^(?<year>\d+)-(?<month>\d+)-(?<day>\d+)T(?<hours>\d+):.*$/,e.timezone==="UTC");break;case"minute":a=`${n==null?void 0:n.y(4)}-${n==null?void 0:n.m(2)}-${n==null?void 0:n.d(2)}T${n==null?void 0:n.h(2)}:${n==null?void 0:n.mi(2)}`,l=n==null?void 0:n.mi(1),y=Z(n==null?void 0:n.ISO,/^(?<year>\d+)-(?<month>\d+)-(?<day>\d+)T(?<hours>\d+):(?<minutes>\d+):.*$/,e.timezone==="UTC");break;case"second":a=`${n==null?void 0:n.y(4)}-${n==null?void 0:n.m(2)}-${n==null?void 0:n.d(2)}T${n==null?void 0:n.h(2)}:${n==null?void 0:n.mi(2)}:${n==null?void 0:n.s(2)}`,l=n==null?void 0:n.s(1),y=Z(n==null?void 0:n.ISO,/^(?<year>\d+)-(?<month>\d+)-(?<day>\d+)T(?<hours>\d+):(?<minutes>\d+):(?<seconds>\d+).*$/,e.timezone==="UTC");break;case"millisecond":a=`${n==null?void 0:n.y(4)}-${n==null?void 0:n.m(2)}-${n==null?void 0:n.d(2)}T${n==null?void 0:n.h(2)}:${n==null?void 0:n.mi(2)}:${n==null?void 0:n.s(2)}.${n==null?void 0:n.ms(3)}`,l=n==null?void 0:n.ms(3);break}d&&d[g]&&(l=`${d[g].prefix||""}${l}${d[g].suffix||""}`,d[g].replacer&&(l=Ye(d[g].replacer,l))),a&&(Object.prototype.hasOwnProperty.call(r,a)?r[a].colspan=i:(i=1,r[a]={colspan:i,content:l,presentTime:y}))}if(!oe(r)){for(const c in r){const d=document.createElement("li");let h={"data-item-datetime":c};if(r[c].colspan>1){h["data-item-colspan"]=String(r[c].colspan);const u=e.minGrainWidth*r[c].colspan;h.style=`width: ${u}px;`}else h.style="width: auto;";r[c].presentTime&&(h["data-item-present-time"]="true"),e.config.rowHeight&&(h.style+=` --ruler-row-height: ${e.config.rowHeight};`),e.config.fontSize&&(h.style+=` --ruler-item-font: ${e.config.fontSize};`),e.config.textColor&&(h.style+=` --ruler-text-color: ${e.config.textColor};`),e.config.backgroundColor&&(h.style+=` --ruler-bg-color: ${e.config.backgroundColor};`),A(d,h),X(d,r[c].content,!1),o.append(d)}t.append(o)}}return t},rt=e=>e.sort((t,o)=>{const s=t.hasOwnProperty("y")?t.y:0,i=o.hasOwnProperty("y")?o.y:0;if(s!==i)return i-s;const r=(t.w??1)*(t.h??1);return(o.w??1)*(o.h??1)-r}),at=(e,t,o,s,i)=>{const r=e.hasOwnProperty("s")?e.s.ts:-1,a=e.hasOwnProperty("e")?e.e.ts:r;let l={containerSize:{width:t,height:o},eventX:e.x,eventY:e.y,eventWidth:e.w,eventHeight:e.h,eventDisplayArea:(e.w??0)*(e.h??0),startBeforeRange:e.x<0||r<s,startAfterRange:e.x>=t||r>=i,endBeforeRange:e.x+e.w<=0||a<=s,endAfterRange:e.x+e.w>t||a>i,isOutOfRange:e.x>=t||e.x+(r<a?e.w:0)<=0,eventLessThanRow:e.y<0,eventExceedingRows:e.y>=o,isOutOfRows:e.y<0||e.y>=o,isEnableEvent:!1};return l.isEnableEvent=!l.isOutOfRange&&!l.isOutOfRows,l},lt=(e,t)=>{const o=document.createDocumentFragment(),s=rt(t),i=G(e),r=i.width,a=i.height,l=Number(e.dataset.rangeStart),c=Number(e.dataset.rangeEnd);s.forEach(d=>{const h=at(d,r,a,l,c);if(!h.isEnableEvent)return;const u=document.createElement("div");u.classList.add("sunorhc-timeline-event-node","preparing"),A(u,{"data-event-id":d.eventId.toString()});const f=[`--event-node-height: ${d.h||16}px`,`--event-node-width: ${d.w||16}px`,`--event-node-y: ${d.y||0}px`,`--event-node-x: ${d.x||0}px`,`--event-node-text-color: ${d.textColor||"inherit"}`,`--event-node-bg-color: ${d.backgroundColor||"inherit"}`,`--event-node-border-width: ${d.borderWidth||1}px`,`--event-node-border-color: ${d.borderColor||"inherit"}`,`--event-node-border-radius: ${d.hasOwnProperty("end")?"2.5px":"50%"}`];F(u,f.join("; ")),d.hasOwnProperty("end")&&(u.classList.add("bar-type"),h.startBeforeRange&&u.classList.add("before-start"),h.endAfterRange&&u.classList.add("after-end"),d.hasOwnProperty("label")&&d.label!==""&&X(u,`<span>${d.label}</span>`,!1)),o.append(u),e.append(o)}),setTimeout(()=>{Array.from(e.querySelectorAll(".sunorhc-timeline-event-node")).forEach(d=>{d.classList.remove("preparing")})},100)},ct=e=>{const t=e.querySelector('[data-ruler-grain="min"] > [data-item-present-time="true"]');if(!t)return;const o=t.offsetLeft,s=t.offsetWidth-1,i=e.querySelector(".sunorhc-timeline-nodes"),r=i.offsetHeight-2,a=document.createElement("div");a.classList.add("present-time-marker"),F(a,`--marker-x: ${o}px; --marker-w: ${s}px; --marker-h: ${r}px;`),i.prepend(a)},dt=e=>{if(e==null)return e;if(e!=="undefined"){if(e==="")return e;if(!isNaN(Number(e)))return parseFloat(e);if(e==="true")return!0;if(e==="false")return!1;try{const t=e.replace(/'([^']+)'/g,'"$1"').replace(/([{,]\s*)([a-zA-Z0-9_]+?)\s*:/g,'$1"$2":').replace(/,\s*}/g,"}").replace(/,\s*]/g,"]");return JSON.parse(t,(o,s)=>{if(typeof s=="string"&&s.startsWith("__FUNCTION__")){const i=s.substring(12);return new Function(`return ${i}`)()}return s})}catch{return e}}},De={display:e=>!e||!/^(boolean|number|string)$/.test(typeof e)?!1:/^(0|1|false|true)$/i.test(String(e))?/^(1|true)$/i.test(String(e)):!1,label:e=>!e||typeof e!="string"?void 0:e,id:e=>!e||typeof e!="string"?void 0:e,flexDirection:e=>!e||typeof e!="string"||!/^(column|row)$/.test(e)?"column":e,textAlign:e=>!e||typeof e!="string"||!/^(left|center|right)$/i.test(e)?void 0:e,textColor:e=>!e||typeof e!="string"?void 0:e,textStyles:e=>!e||typeof e!="string"?void 0:e,textClass:e=>!e||typeof e!="string"?void 0:e},ht={type:e=>!e||typeof e!="string"||!/^(text|avatar|image)$/i.test(e)?"text":e,label:e=>!e||typeof e!="string"?"":e,group:e=>!e||typeof e!="string"?void 0:e,src:e=>!e||typeof e!="string"?void 0:e,action:e=>!e||typeof e!="string"?void 0:e,onClick:e=>!e||!/^(boolean|number|string)$/.test(typeof e)?void 0:/^(0|1|false|true)$/i.test(String(e))?/^(1|true)$/i.test(String(e)):!1,textOverflow:e=>!e||!/^(boolean|number|string)$/.test(typeof e)?!1:/^(0|1|false|true)$/i.test(String(e))?/^(1|true)$/i.test(String(e)):!1,textPosition:e=>!e||typeof e!="string"||!/^(top|center|bottom)?(\s+)?(left|center|right)?$/i.test(e)?void 0:e,textColor:e=>!e||typeof e!="string"?void 0:e,textStyles:e=>!e||typeof e!="string"?void 0:e,iconClass:e=>!e||typeof e!="string"?void 0:e,iconContent:e=>!e||typeof e!="string"?void 0:e,iconWrapClass:e=>!e||typeof e!="string"?void 0:e},ut={placement:e=>!e||typeof e!="string"||!/^(both|left|right|none)$/i.test(e)?"both":e.toLowerCase(),sticky:e=>!e||typeof e!="boolean"?!1:e,overlay:e=>!e||typeof e!="boolean"?!1:e,width:e=>!e||!/^(number|string)$/.test(typeof e)?"150px":/^\d+(|px)$/.test(String(e))?e:"150px",itemHeight:e=>!e||!/^(number|string)$/.test(typeof e)?"80px":/^\d+(|px)$/.test(String(e))?e:"80px",items:e=>!e||!Array.isArray(e)||e.length==0?[]:e.map(t=>B(t,ht))},ft={decorations:e=>!e||typeof e!="object"?void 0:e,monthFormat:e=>!e||typeof e!="string"||!/^(numeric|name)$/.test(e)?void 0:e,monthNames:e=>!e||!Array.isArray(e)?void 0:e.length>0?e:void 0,dayNames:e=>!e||!Array.isArray(e)?void 0:e.length>0?e:void 0,abbreviateMonthNameLength:e=>!e||typeof e!="number"?void 0:e,abbreviateDayNameLength:e=>!e||typeof e!="number"?void 0:e,fullStop:e=>typeof e=="boolean"?e:void 0,dayBackgroundColor:e=>typeof e=="boolean"?e:void 0},ve={rows:e=>!e||!Array.isArray(e)||e.length==0?["day"]:e,rowHeight:e=>!e||!/^(number|string)$/.test(typeof e)?"24px":/^\d+(|px)$/.test(String(e))?e:"24px",fontSize:e=>!e||!/^(number|string)$/.test(typeof e)?"16px":/^\d+(|px)$/.test(String(e))?e:"16px",textColor:e=>!e||typeof e!="string"?void 0:e,backgroundColor:e=>!e||typeof e!="string"?void 0:e},pt={placement:e=>!e||typeof e!="string"||!/^(both|top|bottom|none)$/i.test(e)?"both":e.toLowerCase(),truncateLowers:e=>typeof e=="boolean"?e:!1,firstDayOfWeek:e=>!e||typeof e!="number"?0:e>6?6:e<0?0:Math.floor(e),minGrainWidth:e=>!e||!/^(number|string)$/.test(typeof e)?"48px":/^\d+(|px)$/.test(String(e))?e:"48px",filters:e=>!e||typeof e!="object"?void 0:B(e,ft),top:e=>!e||typeof e!="object"?{rows:["day"]}:B(e,ve),bottom:e=>!e||typeof e!="object"?{rows:["day"]}:B(e,ve)},gt={before:e=>!e||!/^(string|number)$/.test(typeof e)?"":e,after:e=>!e||!/^(string|number)$/.test(typeof e)?"":e,lineSize:e=>!e||typeof e!="number"?void 0:e,lineColor:e=>!e||typeof e!="string"?void 0:e,curve:e=>typeof e=="boolean"||e&&/^((l|r)(t|b)|s|z|n|u|auto)$/.test(String(e))?e:!1},Le={eventId:e=>!e||typeof e!="string"?void 0:e,uid:e=>e||void 0,x:e=>e||void 0,y:e=>e||void 0,w:e=>e||void 0,h:e=>e||void 0,s:e=>e||void 0,e:e=>e||void 0,start:e=>!e||typeof e!="string"?"":e,end:e=>!e||typeof e!="string"?void 0:e,row:e=>!e||typeof e!="number"?0:e,group:e=>!e||typeof e!="string"?void 0:e,label:e=>!e||typeof e!="string"?void 0:e,content:e=>!e||typeof e!="string"?void 0:e,textColor:e=>!e||typeof e!="string"?void 0:e,backgroundColor:e=>!e||typeof e!="string"?void 0:e,borderColor:e=>!e||typeof e!="string"?void 0:e,borderWidth:e=>!e||typeof e!="number"?void 0:e,classes:e=>!e||typeof e!="string"?void 0:e,styles:e=>!e||typeof e!="string"?void 0:e,image:e=>!e||typeof e!="string"?void 0:e,size:e=>!e||!/^(string|number)$/.test(typeof e)?"md":/^(([+-]?(\d+(\.\d*)?|\.\d+)([eE][+-]?\d+)?)|xs|sm|md|lg|xl)$/i.test(String(e))?e:"md",remote:e=>!e||typeof e!="boolean"?!1:e,expiration:e=>!e||!/^(string|number)$/.test(typeof e)?"always":/^(\d+|always|none)$/i.test(String(e))?e:"always",relation:e=>!e||typeof e!="object"?void 0:B(e,gt),extends:e=>!e||typeof e!="object"?void 0:e,callback:e=>!e||typeof e!="function"?void 0:e},mt={elevation:e=>!e||typeof e!="number"?0:e>4?4:e,outlined:e=>!e||typeof e!="string"||!/^(outside|inside|both|none)$/.test(e)?"inside":String(e),outlineCorner:e=>!e||typeof e!="string"||!/^(rounded|squared)$/.test(e)?"squared":String(e),outlineStyle:e=>!e||typeof e!="string"||!/^(solid|dotted|none)$/.test(e)?"solid":String(e),hideScrollbar:e=>typeof e=="boolean"?e:!0,eventsBackground:e=>!e||typeof e!="string"||!/^(striped|grid|toned|plaid|none)$/.test(e)?"plaid":String(e),width:e=>!e||!/^(number|string)$/.test(typeof e)?"auto":typeof e=="number"||/^(\d+(px|%|vw)|auto|inherit|(max|min|fit)-content)$/.test(e)?e:"auto",height:e=>!e||!/^(number|string)$/.test(typeof e)?"auto":typeof e=="number"||/^(\d+(px|%|vh)|auto|inherit|(max|min|fit)-content)$/.test(e)?e:"auto",rtl:e=>typeof e=="boolean"?e:!1},yt={presentTime:e=>typeof e=="boolean"?e:!1,defaultAlignment:e=>!e||!/^(string|number)$/.test(typeof e)||!/^(\d+|left|begin|center|right|end|current(|ly)|latest)$/i.test(String(e))?"latest":typeof e=="string"?e.toLowerCase():e,cacheExpiration:e=>!e||!/^(string|number)$/.test(typeof e)||!/^(\d+|always|none)$/i.test(String(e))?"always":e,hoverEvent:e=>typeof e=="boolean"?e:!1,onClickEvent:e=>!e||typeof e!="string"||!/^(normal|modal|custom|none)$/i.test(e)?"normal":e,template:e=>!e||typeof e!="object"?void 0:Object.keys(e).filter(t=>["tooltip","modal","details","custom"].includes(t)).length>0?e:void 0},bt={name:e=>!e||typeof e!="string"?void 0:e,hookChangeModeClass:e=>!e||typeof e!="string"?void 0:e},wt={start:e=>e||"currently",end:e=>e||"auto",timezone:e=>e||"UTC",scale:e=>!e||typeof e!="string"||!/^(year|month|week|(week|)day|hour|minute|second|millisecond)$/i.test(e)?"day":e.toLowerCase(),file:e=>e&&typeof e=="string"?e:void 0,header:e=>!e||typeof e!="object"?{display:!1}:B(e,De),footer:e=>!e||typeof e!="object"?{display:!1}:B(e,De),sidebar:e=>!e||typeof e!="object"?{placement:"both",sticky:!1,overlay:!1,width:"150px",itemHeight:"80px",items:[]}:B(e,ut),ruler:e=>!e||typeof e!="object"?{placement:"both",minGrainWidth:"48px"}:B(e,pt),events:e=>!e||!/^(string|object)$/.test(typeof e)?[]:Array.isArray(e)?e.map(t=>B(t,Le)):typeof e=="string"?e:[],layout:e=>!e||typeof e!="object"?void 0:B(e,mt),effects:e=>!e||typeof e!="object"?{presentTime:!1,defaultAlignment:"latest",cacheExpiration:"always",hoverEvent:!0,onClickEvent:"normal"}:B(e,yt),theme:e=>!e||typeof e!="object"?void 0:B(e,bt),useStorage:e=>!e||typeof e!="string"||!/^(session|local)Storage$/i.test(e)?"sessionStorage":e,zoomable:e=>typeof e=="boolean"?e:!1,debug:e=>typeof e=="boolean"?e:!1,extends:e=>!e||typeof e!="object"?void 0:e},B=(e,t)=>{const o={},s=t||wt;for(const i in e)if(i in s&&typeof s[i]=="function"){const r=s[i](e[i]);r!==void 0&&(o[i]=r)}else console.warn(`Property "%c${i}%c" is not defined in the TimelineOptions interface and will be ignored.`,"color:red;font-weight:bold;","");return o};class Tt{trace(...t){console.trace(...t)}debug(...t){console.debug(...t)}info(...t){console.info(...t)}error(...t){console.error(...t)}}class Ct{constructor(t){O(this,"logger");O(this,"debug");this.debug=t.debug;const o=[];t.debug&&o.push({target:"pino-pretty",options:{colorize:!0},level:"debug"}),t.logFilePath&&o.push({target:"pino/file",options:{destination:`@/../logs/${t.logFilePath}`,mkdir:!0},level:this.debug?"trace":"info"});try{const s=require("pino");this.logger=s({level:this.debug?"trace":"info",transport:{targets:o}})}catch{this.logger=new Tt}}log(...t){this.debug?this.logger.trace(...t):this.logger.debug(...t)}info(...t){this.logger.info(...t)}error(...t){this.logger.error(...t)}}const Pe=!1,St="prod-log.log",$t={start:"currently",end:"auto",timezone:"UTC",scale:"day",file:null,header:{display:!1},footer:{display:!1},sidebar:{placement:"both",sticky:!1,overlay:!1,width:"150px",itemHeight:"80px",items:[]},ruler:{placement:"both",truncateLowers:!1,firstDayOfWeek:0,minGrainWidth:"48px",top:{rows:["day"]},bottom:{rows:["day"]}},events:"",layout:{hideScrollbar:!0,eventsBackground:"plaid",width:"auto",height:"auto"},effects:{presentTime:!1,defaultAlignment:"latest",cacheExpiration:"always",hoverEvent:!1,onClickEvent:"normal"},theme:{name:"default"},useStorage:"sessionStorage",zoomable:!1,debug:Pe},ie=class ie{constructor(t,o){O(this,"elementId");O(this,"targetElement");O(this,"fragmentNode");O(this,"options",$t);O(this,"inputOptions");O(this,"loadOptions",null);O(this,"measurements",{});O(this,"eventNodes",[]);O(this,"logger");this.elementId=t,this.targetElement=document.querySelector(`#${t}`),this.fragmentNode=document.createDocumentFragment(),this.inputOptions=o??{};const s={debug:(Object.prototype.hasOwnProperty.call(this.inputOptions,"debug")?this.inputOptions.debug:Pe)||!1,logFilePath:St};this.logger=new Ct(s)}static async create(t,o){const s=new ie(t,o);try{s.options=await Promise.resolve(s.initOptions()),s.measurements=await Promise.resolve(s.initMeasure()),await Promise.resolve(s.render()),s.initialized(),await Promise.resolve(s.serveEventNodes()),s.registerEventListeners(),s.runChangeThemeWatcher()}catch(i){console.error("Failed to create timeline:",i),F(s.targetElement,{display:"none"})}finally{window.hasOwnProperty("SunorhcTimelineInstances")||(window.SunorhcTimelineInstances={}),window.SunorhcTimelineInstances[s.elementId]=s}return s}async initOptions(){let t=j({},this.options);if(this.targetElement.dataset.options){const o=dt(this.targetElement.dataset.options);if(K(o)){const s=B(o);t=j(t,s)}else typeof o=="string"&&(t=j(t,{file:o}))}if(this.inputOptions&&K(this.inputOptions)&&!oe(this.inputOptions)&&(t=j(t,this.inputOptions),this.inputOptions.start instanceof Date&&(t.start=this.inputOptions.start),this.inputOptions.end instanceof Date&&(t.end=this.inputOptions.end)),t.hasOwnProperty("file")&&typeof t.file=="string"&&t.file!==""){const o=await ce({url:t.file});t=j(t,B(o)),this.logger.log("Fetched options file:",o,B(o),t)}return this.logger.info(`%cSnorch.Timeline ver.${ie.VERSION} is booting now...`,"color: #0284c7; font-weight: 700;"),t}getOptions(t=!1){return t?se(this.options):this.options}async initMeasure(){var a,l,c,d,h,u,f,n,y,g,E,$,M,w,C,U;const t=document.createElement("div");t.classList.add("sunorhc-timeline-container","preparing");const o={"data-timeline-outlined":this.options.layout&&/^(outside|both)$/.test(this.options.layout.outlined)?"true":"false"};this.options.layout.outlineCorner&&(o["data-timeline-linestyle"]=this.options.layout.outlineCorner),this.options.layout.elevation&&(o["data-timeline-elevation"]=this.options.layout.elevation.toString()),this.options.layout.rtl&&(o.dir=this.options.layout.rtl?"rtl":"ltr"),A(t,o);const s=this.options.layout.width||"auto",r=["width: "+(typeof s=="number"?`${s}px`:s),"height: "+"auto"];this.options.layout.outlineStyle&&r.push(`--outline-style: ${this.options.layout.outlineStyle}`),F(t,r.join("; ")),this.fragmentNode.append(t),this.targetElement.append(this.fragmentNode);try{const p=be(this.options.start,this.options.timezone,this.options.scale);if(p instanceof Error)throw p;const m=we(this.options.end,this.options.timezone,this.options.scale,p);if(m instanceof Error)throw m;const b=((a=this.options.ruler.filters)==null?void 0:a.monthNames)??void 0,D=((l=this.options.ruler.filters)==null?void 0:l.dayNames)??void 0,S=this.options.ruler.firstDayOfWeek||0,k=Q(p,this.options.timezone,b,D,S),v=Q(m,this.options.timezone,b,D,S),P=Ue(p,m),L=Ue(p,m,this.options.scale),H=G(this.targetElement),x=We(G(t)),T=J(this.options.sidebar.width),V=J(this.options.sidebar.itemHeight),ae=((d=(c=this.options.ruler.top)==null?void 0:c.rows)==null?void 0:d.length)||0,N=((u=(h=this.options.ruler.bottom)==null?void 0:h.rows)==null?void 0:u.length)||0,Y=J((f=this.options.ruler.top)==null?void 0:f.rowHeight)||24,z=J((n=this.options.ruler.bottom)==null?void 0:n.rowHeight)||24;let W={startDate:k,endDate:v,particles:P,injectTo:H,container:x,containerWidth:x.width,containerHeight:x.height,containerTop:x.top,containerLeft:x.left,bodyHeight:void 0,sidebarWidth:T,sidebarHeight:V*this.options.sidebar.items.length,sidebarVisibleHeight:void 0,sidebarOffsetTop:/^(both|top)/i.test(this.options.ruler.placement)?ae*Y:0,sidebarOffsetBottom:/^(both|bottom)/i.test(this.options.ruler.placement)?N*z:0,sidebarItemHeight:V,sidebarItems:this.options.sidebar.items.length,rulerVisibleWidth:x.width-(/^both$/i.test(this.options.sidebar.placement)?T*2:/^(left|right)$/i.test(this.options.sidebar.placement)?T:0),rulerActualWidth:J(this.options.ruler.minGrainWidth)*L,rulerTopRows:((g=(y=this.options.ruler.top)==null?void 0:y.rows)==null?void 0:g.length)||0,rulerBottomRows:(($=(E=this.options.ruler.bottom)==null?void 0:E.rows)==null?void 0:$.length)||0,rulerTopHeight:(((w=(M=this.options.ruler.top)==null?void 0:M.rows)==null?void 0:w.length)||0)*Y,rulerBottomHeight:(((U=(C=this.options.ruler.bottom)==null?void 0:C.rows)==null?void 0:U.length)||0)*z,rulerMaxCols:L};if(this.logger.log("initMeasure:",this.elementId,this.options,W),W.sidebarItems==0||W.rulerTopRows+W.rulerBottomRows==0)throw new Error("Missing several configurations to generate timeline.");return Promise.resolve(W)}catch(p){return Promise.reject(p)}}async render(){var T,V,ae;const t=se(this.measurements),o=N=>N.filter(Y=>!!Y);let s=null;const i=Me("header",this.options.header),r=document.createElement("div");r.classList.add("sunorhc-timeline-body"),A(r,{"data-timeline-outlined":this.options.layout&&/^(inside|both)$/.test(this.options.layout.outlined)?"true":"false","data-timeline-linestyle":this.options.layout?this.options.layout.outlineCorner:""});let a=[];if(this.options.layout){if(this.options.layout.height&&this.options.layout.height!=="auto"){let N=typeof this.options.layout.height=="string"?J(this.options.layout.height):this.options.layout.height;a.push(`height: ${N}px`)}this.options.layout.outlineStyle&&a.push(`--outline-style: ${this.options.layout.outlineStyle}`)}F(r,a.join("; "));const l={left:/^(both|left)$/i.test(this.options.sidebar.placement)?Ee("left",t):void 0,right:/^(both|right)$/i.test(this.options.sidebar.placement)?Ee("right",t):void 0};for(const N in l)if(l.hasOwnProperty(N)&&l[N]&&ne(l[N])){const Y=nt(this.options.sidebar);this.options.ruler.placement==="bottom"&&this.options.layout.outlined==="inside"&&F(Y,{borderTop:"none"}),l[N].append(Y)}const c=document.createElement("div");c.classList.add("sunorhc-timeline-main-canvas"),this.options.layout.hideScrollbar&&A(c,{"data-hide-scrollbar":"true"});const d=[`--main-visible-width: ${t.rulerVisibleWidth}px`];this.options.ruler.placement==="bottom"&&this.options.layout.outlined==="both"&&d.push(`border-top: ${((T=this.options.layout)==null?void 0:T.outlineStyle)||"solid"} 1px var(--border-color)`),F(c,d.join("; "));const h={top:/^(both|top)$/i.test(this.options.ruler.placement)?ke("top",t):void 0,bottom:/^(both|bottom)$/i.test(this.options.ruler.placement)?ke("bottom",t):void 0};for(const N in h)h.hasOwnProperty(N)&&h[N]&&ne(h[N])&&this.options.ruler.hasOwnProperty(N)&&(N==="top"?this.options.ruler.top.rows:this.options.ruler.bottom.rows).forEach((z,W)=>{const R={globalScale:this.options.scale,timezone:this.options.timezone,scale:z,order:W+1,minGrainWidth:J(this.options.ruler.minGrainWidth),placement:N,firstDayOfWeek:this.options.ruler.firstDayOfWeek,config:N==="top"?this.options.ruler.top:this.options.ruler.bottom,filters:this.options.ruler.filters,maxCols:t.rulerMaxCols,startDate:t.startDate,endDate:t.endDate};h[N].append(it(R)),this.options.ruler.filters&&this.options.ruler.filters.dayBackgroundColor&&h[N].classList.add("force-day-bg-color")});const u=document.createElement("div");u.classList.add("sunorhc-timeline-nodes"),A(u,{"data-grid-width":J(this.options.ruler.minGrainWidth).toString(),"data-grid-height":t.sidebarItemHeight.toString(),"data-grid-max-cols":t.rulerMaxCols.toString(),"data-grid-max-rows":t.sidebarItems.toString(),"data-range-start":t.startDate.ts.toString(),"data-range-end":t.endDate.ts.toString(),"data-background":this.options.layout.eventsBackground||"plaid"});let f=/^(both|top)$/.test(this.options.ruler.placement)?t.rulerTopHeight:0;f+=/^(both|bottom)$/.test(this.options.ruler.placement)?t.rulerBottomHeight:0;const n=Math.floor(J(this.options.ruler.minGrainWidth)),y=Math.floor(t.sidebarItemHeight);F(u,`      --canvas-grid-width: ${n}px;       --canvas-grid-height: ${y}px;       --canvas-grid-cols: ${t.rulerMaxCols};       --canvas-grid-rows: ${t.sidebarItems};       --canvas-grid-rows-half: ${t.sidebarItems/2};       --canvas-grid-interval: -1px;       width: ${t.rulerActualWidth}px;       height: calc(100% - ${f}px);     `),s=o([h.top,u,h.bottom]),c.append(...s);const E=Me("footer",this.options.footer);s=o([l.left,c,l.right]),r.append(...s),s=o([i,r,E]),this.fragmentNode.append(...s);const $=this.targetElement.querySelector(".sunorhc-timeline-container");$.append(this.fragmentNode);const M=$.querySelector(".sunorhc-timeline-body"),w=G(r,"height"),C=t.sidebarHeight+(t.sidebarOffsetTop+t.sidebarOffsetBottom),U=w<C?Math.floor(w):C;t.bodyHeight=U,t.sidebarVisibleHeight=U-(t.sidebarOffsetTop+t.sidebarOffsetBottom);const p=$.querySelector(".sunorhc-timeline-nodes"),m=Array.from($.querySelectorAll(".sunorhc-timeline-ruler"));let b;const D=M.querySelector(".sunorhc-timeline-main-canvas"),S=G(m.filter(N=>N.dataset.rulerPosition==="top")[0],"height"),k=G(m.filter(N=>N.dataset.rulerPosition==="bottom")[0],"height"),v=Array.from($.querySelectorAll(".sunorhc-timeline-sidebar"));let P,L,H,x;if(t.sidebarVisibleHeight<t.sidebarHeight){const N=[`--sidebar-max-width: ${t.sidebarWidth}px`,`--sidebar-max-height: ${t.sidebarVisibleHeight}px`,`margin-top: ${t.sidebarOffsetTop}px`,`margin-bottom: ${t.sidebarOffsetBottom}px`];A(Array.from($.querySelectorAll(".sunorhc-timeline-sidebar")),{"data-sidebar-overflow":"true",style:N.join("; ")}),b=ee(p,"style").split(";").filter(W=>W!=="").map(W=>{const R=W.trim();return/^height\:/.test(R)?`height: ${t.sidebarHeight}px`:R}),m.forEach(W=>{const R=ee(W,"data-ruler-position");A(W,{"data-overlay-sticky":R})}),F(p,b.join("; "));const Y=(V=$.querySelector('.sunorhc-timeline-ruler[data-ruler-position="top"]'))==null?void 0:V.clientHeight,z=(ae=$.querySelector('.sunorhc-timeline-ruler[data-ruler-position="bottom"]'))==null?void 0:ae.clientHeight;v.forEach(W=>{P=S-J(W.style.marginTop),H=ee(W,"style"),x=H.split(/;\s?/).filter(R=>R!==""),S&&!k?(x.forEach((R,_)=>{/^margin-top\:/.test(R)&&/^(inside|both)$/.test(this.options.layout.outlined??"")&&(x[_]=`margin-top: ${Y}px`)}),/^(inside|both)$/.test(this.options.layout.outlined??"")&&(D.style.height=this.options.layout.outlined==="inside"?"100%":"calc(100% - 1px)",this.options.layout.outlined==="both"&&(A(M,{"data-timeline-linestyle":""}),M.style.height=`${w+1}px`,D.classList.add("border-bottom"),W.querySelector(".sunorhc-timeline-sidebar-items").classList.add("border-bottom")))):!S&&k?(x.forEach((R,_)=>{/^margin-top\:/.test(R)&&(/^(inside|both)$/.test(this.options.layout.outlined??"")?x[_]=(this.options.layout.outlined==="inside","margin-top: 0px"):x[_]="margin-top: -2px"),/^margin-bottom\:/.test(R)&&(x[_]=`margin-bottom: ${z}px`),/^(outside|none|both)$/.test(this.options.layout.outlined??"")&&/^--sidebar-max-height:/.test(R)&&(L=parseInt(R.replace(/^--sidebar-max-height:\s(\d+)px$/,"$1"),10),x[_]=this.options.layout.outlined==="both"?`--sidebar-max-height: ${L+1}px`:`--sidebar-max-height: ${L-4}px`)}),/^(inside|both)$/.test(this.options.layout.outlined??"")?this.options.layout.outlined==="both"&&A(M,{"data-timeline-linestyle":""}):x.push("border-bottom: none"),$.querySelector('.sunorhc-timeline-ruler[data-ruler-position="bottom"]').style.top="0px"):!S&&!k?(x.forEach((R,_)=>{/^(outside|none)$/.test(this.options.layout.outlined??"")?/^--sidebar-max-height:/.test(R)&&(L=parseInt(R.replace(/^--sidebar-max-height:\s(\d+)px$/,"$1"),10),x[_]=`--sidebar-max-height: ${L-t.sidebarItems}px`):/^margin-top\:/.test(R)&&(x[_]="margin-top: 0")}),/^(outside|none)$/.test(this.options.layout.outlined??"")?(x.push("border-bottom: none"),D.style.top="1px"):this.options.layout.outlined==="inside"?(x.push("border-bottom: none"),D.style.height="100%"):(D.style.height="100%",D.classList.add("border-top","border-bottom"),A(M,{"data-timeline-linestyle":""}))):this.options.layout.outlined!=="inside"?(x.forEach((R,_)=>{/^margin-top\:/.test(R)&&(x[_]=`margin-top: ${Y}px`),/^margin-bottom\:/.test(R)&&(x[_]=`margin-bottom: ${z}px`)}),$.querySelector('.sunorhc-timeline-ruler[data-ruler-position="top"]').style.top="0",D.style.height="calc(100% + 1px)",this.options.layout.outlined!=="both"?P=0:(console.log("!!!:",G(W),G($.querySelector('.sunorhc-timeline-ruler[data-ruler-position="bottom"]'))),$.querySelector('.sunorhc-timeline-ruler[data-ruler-position="bottom"] .sunorhc-timeline-ruler-row[data-ruler-grain="max"]').style.height="100%")):(x.forEach((R,_)=>{/^margin-top\:/.test(R)&&(x[_]=`margin-top: ${Y}px`)}),D.style.height="calc(100% + 1px)",P=0,$.querySelector('.sunorhc-timeline-ruler[data-ruler-position="bottom"] .sunorhc-timeline-ruler-row[data-ruler-grain="max"]').style.borderBottomStyle="none"),this.options.layout.outlineStyle==="dotted"&&(W.dataset.sidebarPosition==="left"?x.push("border-right: none"):x.push("border-left: none"),$.querySelector('.sunorhc-timeline-ruler[data-ruler-position="bottom"]').style.top="-1.5px"),x.unshift(`--sidebar-adjust-top: ${P}px`),A(W,{style:x.join("; ")})})}else{b=ee(p,"style").split(";").filter(Y=>Y!=="").map(Y=>{const z=Y.trim();return/^height\:/.test(z)?`height: ${t.sidebarHeight+2}px`:z}),F(p,b.join("; "));let N=0;m.forEach(Y=>{const z=Math.ceil(G(Y,"height"));F(Y,{height:`${z}px`}),N+=z}),F(M,{height:`${Math.floor(N+t.sidebarHeight)}px`}),v.forEach(Y=>{P=S-J(Y.style.marginTop),H=ee(Y,"style"),x=H.split(/;\s?/).filter(z=>z!==""),S&&!k?(console.log("Top ruler only!!!:",S,k,this.options.layout.outlined,w),/^(inside|both)$/.test(this.options.layout.outlined??"")&&(D.style.height="100%",this.options.layout.outlined==="both"&&(M.style.height=`${w+1}px`,D.classList.add("border-bottom"),Y.querySelector(".sunorhc-timeline-sidebar-items").classList.add("border-bottom")))):!S&&k&&(console.log("Bottom ruler only!!!:",S,k),x.forEach((z,W)=>{/^margin-top\:/.test(z)&&(x[W]=this.options.layout.outlined==="inside"?"margin-top: -2px":"margin-top: -1px"),/^margin-bottom\:/.test(z)&&(x[W]=`margin-bottom: ${k}px`)}),$.querySelector('.sunorhc-timeline-ruler[data-ruler-position="bottom"]').style.top="-1.75px",D.style.height="100%"),this.options.layout.outlineStyle==="dotted"&&(Y.dataset.sidebarPosition==="left"?x.push("border-right: none"):x.push("border-left: none"),$.querySelector('.sunorhc-timeline-ruler[data-ruler-position="bottom"]').style.top="-1.5px"),x.unshift(`--sidebar-adjust-top: ${P}px`),A(Y,{style:x.join("; ")})})}this.measurements=t,$.classList.remove("preparing")}async serveEventNodes(t=!1){const o=`${this.elementId}:cachedEvents`;let s=null,i=[];t&&this.logger.log("Force clear cache!");try{if(typeof this.options.events=="string"&&this.options.events!==""){if(this.options.events===o){let r=-1;/^\d+$/i.test(String(this.options.effects.cacheExpiration))?r=Number(this.options.effects.cacheExpiration):/^always$/i.test(String(this.options.effects.cacheExpiration))&&(r=0),s=je(this.options.useStorage,o,r),s!==null&&Array.isArray(s)&&s.length!==0&&(this.logger.log("Loaded cached event data:",s),this.options.events=s)}if(!K(this.options.events)&&this.options.events!==o){if(s=await ce({url:this.options.events}),!s||!Array.isArray(s)||s.length==0)throw new Error("The fetched data does not contain any event nodes.");this.logger.log("Fetched external event data:",s),this.options.events=s}}else if(Array.isArray(this.options.events)&&this.options.events.length==0)throw new Error("No enabled events within the current timeline display range.");if(!oe(this.options.events)){this.eventNodes=[],this.options.events.forEach((a,l)=>{var d,h;let c=B(a,Le);if(c.hasOwnProperty("eventId"))i.push(c.eventId);else{const u=`EventNode:${String(l+1)}`;c.eventId=u,i.push(u)}if(c.hasOwnProperty("start")){const u=((d=this.options.ruler.filters)==null?void 0:d.monthNames)??void 0,f=((h=this.options.ruler.filters)==null?void 0:h.dayNames)??void 0,n=this.options.ruler.firstDayOfWeek||0,y=Q(c.start,this.options.timezone,u,f,n);if(y){c.s=y;const g=Ve(c,this.options,this.measurements);this.eventNodes.push(g)}}});const r=Fe(i);r.length>0&&r.forEach(a=>{let l=0;for(let c of this.eventNodes){const d=c;d.eventId===a&&(l++,l>1&&(d.eventId=`EventNode:${String(d.uid)}`))}}),Ke(this.options.useStorage,o,this.options.events,!0),this.options.events=o}}catch(r){console.warn(r)}finally{const r=this.targetElement.querySelector(".sunorhc-timeline-nodes");lt(r,this.eventNodes),this.logger.log("serveEventNodes:",this.eventNodes,this.options.events,this.options.effects.presentTime),this.options.effects.presentTime&&ct(this.targetElement)}}runChangeThemeWatcher(){var o;const t=this.targetElement.querySelector(".sunorhc-timeline-container");window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?t.classList.add("dark-theme"):t.classList.remove("dark-theme"),(o=window==null?void 0:window.matchMedia("(prefers-color-scheme: dark)"))==null||o.addEventListener("change",s=>{s.matches?t.classList.add("dark-theme"):t.classList.remove("dark-theme")}),Xe(document.body,s=>{const i=s;i.type==="attributes"&&i.attributeName==="class"&&(i.target.classList.contains(this.options.theme.hookChangeModeClass)?t.classList.add("dark-theme"):t.classList.remove("dark-theme"))},{attributes:!0,childList:!1,subtree:!1})}registerEventListeners(){const t=se(this.measurements);this.logger.log("registerEventListeners:",t),t.rulerActualWidth>t.rulerVisibleWidth&&(Ze(this.targetElement),xe(this.targetElement,this.options.effects.defaultAlignment)),t.sidebarHeight>t.sidebarVisibleHeight&&et(this.targetElement),this.options.zoomable&&ot(this.targetElement,this.options),this.options.effects.hoverEvent&&tt(this.targetElement,this.options,this.eventNodes),this.options.effects.onClickEvent!=="none"&&st(this.targetElement,this.options,this.eventNodes)}async initialized(t){t&&(this.logger.log('Callbackable "initialized" hook:'),await Promise.resolve(t(this)))}async reload(t,o){this.logger.log('Called "reload"',this.targetElement);const s=G(this.targetElement),i=ee(this.targetElement,"style");F(this.targetElement,`min-width: ${s.width}px; min-height: ${s.height}px; ${i}`),X(this.targetElement,"",!1);try{if(t){const r=j(this.options,t);t.hasOwnProperty("start")&&t.start instanceof Date&&(r.start=t.start),t.hasOwnProperty("end")&&t.end instanceof Date&&(r.end=t.end),this.options=r}else this.options=await Promise.resolve(this.initOptions());this.measurements=await Promise.resolve(this.initMeasure()),await Promise.resolve(this.render()),this.initialized(),await Promise.resolve(this.serveEventNodes()),this.registerEventListeners(),this.runChangeThemeWatcher()}catch(r){console.error("Failed to create timeline:",r),F(this.targetElement,{display:"none"})}finally{o&&await Promise.resolve(o(this))}}async align(t,o){xe(this.targetElement,t),o&&await Promise.resolve(o(this))}async zoom(t,o){if(typeof t!="object"||typeof t.scale!="string"||typeof t.start!="string"&&!(t.start instanceof Date))return Promise.reject(new Error("Invalid zoom option."));this.reload({start:t.start,end:t.end,scale:t.scale,ruler:t.ruler}),o&&await Promise.resolve(o(this))}};O(ie,"VERSION",q);let he=ie;I.Timeline=he,Object.defineProperty(I,Symbol.toStringTag,{value:"Module"})});
